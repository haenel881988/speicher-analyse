# Änderungsprotokoll

> **Regel:** Maximal 30 Einträge. Bei Überschreitung die ältesten in `archiv/` verschieben (Dateiname: `aenderungsprotokoll_<version>.md`).

Archiv: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (30 Einträge, v7.0–v7.2)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md) (15 Einträge, v7.3–v7.5)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v8.0.md`](archiv/aenderungsprotokoll_v7.3-v8.0.md) (15 Einträge, v7.3–v8.0)
Archiv: [`archiv/aenderungsprotokoll_v7.2.1-v7.3.md`](archiv/aenderungsprotokoll_v7.2.1-v7.3.md) (15 Einträge, v7.2.1–v7.3)
Archiv: [`archiv/aenderungsprotokoll_v7.2.1-n31-45.md`](archiv/aenderungsprotokoll_v7.2.1-n31-45.md) (15 Einträge, #31–#45)
Archiv: [`archiv/aenderungsprotokoll_n46-60.md`](archiv/aenderungsprotokoll_n46-60.md) (15 Einträge, #46–#60)
Archiv: [`archiv/aenderungsprotokoll_n61-75.md`](archiv/aenderungsprotokoll_n61-75.md) (15 Einträge, #61–#75)

---

| # | Datum | Version | Typ | Beschreibung |
|---|-------|---------|-----|-------------|
| 99 | 2026-02-19 | v7.2.1 | feature | **Eigenschaften-Dialog mit 4 Tabs wie Windows Explorer** — Kompletter Umbau des Datei-Eigenschaften-Dialogs von flacher Key-Value-Liste zu 4-Tab-Layout: (1) Allgemein: Großes Dateityp-Icon, Dateiname, Dateityp-Beschreibung (via assoc/ftype), Öffnen-mit-Programm, Speicherort, Größe + Größe auf Datenträger (Cluster-aligned via Get-Volume), Enthält (Ordner: async), Erstellt/Geändert/Zugriff, Attribute-Checkboxen (Schreibgeschützt/Versteckt/Archiv). (2) Sicherheit: Besitzer (Owner), ACL-Tabelle mit Benutzer/Gruppe, Zulassen/Verweigern, Berechtigungen (Vollzugriff/Ändern/Lesen/Schreiben), geerbt-Markierung. (3) Details: Erweiterte Metadaten via Shell.Application COM-Objekt (Abmessungen, Kameramodell, Interpret, Album, Dauer, Bitrate, Aufnahmedatum etc.), EXE/DLL VersionInfo (Produktname, Version, Firma, Copyright), MD5/SHA-256 Prüfsummen-Buttons (on-demand). (4) Vorgängerversionen: Volume Shadow Copy Snapshots mit Datum, Typ und Größe. 5 neue Backend-Commands (file_properties_general, file_properties_security, file_properties_details, file_properties_versions, file_properties_hash), 5 Bridge-Mappings, PropertiesDialog-Klasse mit Lazy-Loading pro Tab und Cache. getFileIcon/FILE_TYPE_ICONS/EXT_TO_ICON aus explorer.js exportiert für Wiederverwendung. |
| 98 | 2026-02-19 | v7.2.1 | refactor | **Verwaiste Scanner-CSS bereinigt** — 105 Zeilen toter CSS-Code aus style.css entfernt: netinv-* (Geräte-Inventar-Tabelle, 16 Gerätetyp-Farben, Gruppierung, Badges), network-device-* (Geräte-Zeilen, Detail-Ansicht, Status-Anzeige), network-scan-* (Scan-Fortschritt, Spinner, Progress-Bar), network-rtt-* (Latenz-Farbkodierung), network-port-badge, network-local-badge, network-privacy-badge und 2 zugehörige @keyframes-Animationen. Behalten: network-devices-toolbar (von History-View genutzt) und network-state-pills (von Verbindungs-Detail genutzt). |
| 97 | 2026-02-19 | v7.2.1 | refactor | **IP-Scanner aus Netzwerk-Monitor entfernt** — Gesamten "Lokale Geräte"-Tab mit ~470 Zeilen totem Frontend-Code entfernt (Netzwerk-Scan, Port-Scan, SMB-Freigaben, Geräte-Inventar, CSV-Export, Blockieren-Button, 17 SVG-Geräte-Icons). Backend/Bridge hatten keine Scanner-Commands (nie implementiert nach Tauri-Migration). oui.rs bleibt erhalten (hostname_to_company + is_tracker werden vom Verbindungs-Monitor benötigt). 5 Log-Analyse-Findings (Akku-Polling, doppelte Verzeichnis-Abfragen, IP-Auflösung 12s, Sicherheits-Check 17s, doppelte Laufwerk-Abfrage) in issue.md dokumentiert. Strategische Entscheidung in issue.md als "Umgesetzt" markiert. |
| 96 | 2026-02-19 | v7.2.1 | refactor | **Letzte Electron-Fragmente bereinigt** — Systematische Suche nach Electron-Resten im gesamten Projekt: (1) terminal-panel.js Kommentar korrigiert ("node-pty" durch "piped I/O" ersetzt). (2) issue.md: Veralteten Eintrag "restore-window.ps1 sucht nach Electron" entfernt (bereits in v7.2.1 #95 gefixt). (3) projektplan.md: "Electron powerMonitor" durch "Web Battery API + Tauri System-Info" ersetzt. (4) visionen.md: "Electron" durch "Tauri v2" ersetzt. (5) Changelog: 5 Electron-Ära Lessons (#4-#8) entfernt — bereits in docs/lessons-learned archiviert, für Tauri irrelevant. Drittanbieter-Libs (Monaco, mammoth, html2pdf), historische Docs und Lessons-Learned korrekt als "kein Handlungsbedarf" verifiziert. |
| 95 | 2026-02-19 | v7.2.1 | improve | **Tiefenanalyse-Fixes: 14 Findings behoben (3 Kritisch, 4 Hoch, 3 Mittel, 1 Niedrig, 3 kein Fix nötig)** — Ergebnis der systematischen Tiefenanalyse v2.2. (1) KRITISCH K-1: Scanner/Firewall/Registry-Code komplett entfernt (~849 Zeilen commands.rs, registry.js gelöscht, oui.rs auf hostname_to_company+is_tracker reduziert, Bridge/lib.rs/app.js/dashboard.js/index.html bereinigt) — AV-Risiko eliminiert. (2) KRITISCH K-2: `unsafe-eval` aus CSP entfernt. (3) KRITISCH K-3: `validate_path()` Prüfung vor `delete_to_trash` hinzugefügt. (4) HOCH H-1: restore-window.ps1 Electron-Referenz auf Speicher-Analyse korrigiert. (5) HOCH H-2: Toten Event-Listener `onFileOpProgress` entfernt (3 weitere als gültig verifiziert). (6) HOCH H-3: Mutex `.lock().unwrap()` durch `.unwrap_or_else(|e| e.into_inner())` ersetzt — verhindert Cascade-Panics bei Mutex-Poisoning (commands.rs + scan.rs). (7) HOCH H-4: 3 englische PowerShell-Fehlermeldungen auf Deutsch übersetzt (ps.rs). (8) HOCH H-6: `destroy()` Methode zu 15 Views hinzugefügt (autostart, bloatware, cleanup, dashboard, duplicates, old-files, optimizer, preview, search, security-audit, services, settings, system-profil, tree, updates). (9) MITTEL M-1: `#[allow(dead_code)]` von ScanData entfernt. (10) MITTEL M-6: `open_external` blockiert URLs mit `@` (eingebettete Anmeldedaten). (11) NIEDRIG N-4: `delete_network_recording` von `std::fs` auf `tokio::fs` migriert (async). 3 Findings als bereits korrekt implementiert bestätigt (H-7 activate/deactivate, H-8 stub-check system_score, M-4 read-Pfade). |
| 94 | 2026-02-18 | v7.2.1 | refactor | **CLAUDE.md Lesson-Learned-Migration + Gründlichkeits-Policy** — Sämtliche Lesson-Learned-Inhalte (historische Anekdoten, Migrations-Erzählungen, Bug-Referenzen) aus CLAUDE.md in `docs/lessons-learned/lessons-learned.md` migriert (#86, #87). CLAUDE.md enthält jetzt nur noch Prinzipien und Regeln, keine Geschichten. Neue Policy "Prinzip 3c: Gründlichkeit vor Effizienz" hinzugefügt — verbietet oberflächliche Quick-Scans und erzwingt vollständiges Lesen, alle Treffer prüfen, Analysen abschliessen. Veraltete API-Zahlen korrigiert (147→150 Methoden, 21 Event-Listener). MEMORY.md synchronisiert. |
| 93 | 2026-02-18 | v7.2.1 | security | **XSS-Fix: escapeHtml() escaped keine Anführungszeichen** — `escapeHtml()` in utils.js nutzte den `textContent→innerHTML`-DOM-Trick, der laut HTML-Spec nur `<>&` escaped, NICHT `"'`. In 15+ Dateien wurde `escapeHtml()` in Attribut-Kontexten verwendet (`title="..."`, `data-path="..."`, `value="..."`) → Dateinamen mit `"` hätten aus Attributen ausbrechen können. Fix: Regex-basierte Implementierung die `&<>"'` escaped. `escapeAttr()` = Alias für `escapeHtml()`. 4 lokale Varianten entfernt (autostart.js eigene `esc()`, explorer.js `escAttr()`, explorer-tabs.js `_escAttr()`, treemap.js `escapeHtml()`). Bridge-Zähler korrigiert (150/21 statt 149/22). Lesson-Learned #85 dokumentiert. |
| 92 | 2026-02-18 | v7.2.1 | fix | **Tiefenanalyse: 13 Bugs gefixt (6 Crash, 3 Funktionsfehler, 4 Qualität)** - (1) KRITISCH: `deleteToTrash`/`deletePermanent`/`clipboardPaste` riefen `.filter()` auf einzelnem Objekt statt Array → TypeError bei jeder Datei-Operation. Fix: Frontend prüft jetzt `result.success` direkt. (2) KRITISCH: `file_properties` gibt `isDir`/`readOnly` zurück, Frontend las `isDirectory`/`readonly` → Ordner immer als "Datei" angezeigt, Schreibschutz immer "Nein". Fix: Beide Varianten per `||` akzeptiert. (3) KRITISCH: `calculateFolderSize` Feldnamen `result.size`/`files`/`dirs` statt Backend-Return `totalSize`/`fileCount`/`dirCount`. Fix: Korrekte Feldnamen. (4) KRITISCH: `delete_to_trash` nutzte `DeleteFile()` — scheiterte bei Ordnern. Fix: `Test-Path -PathType Container` → `DeleteDirectory()` für Ordner. (5) KRITISCH: `file_copy` via `tokio::fs::copy()` konnte keine Ordner kopieren. Fix: Rekursive Kopie mit `walkdir`. (6) HOCH: `show_save_dialog` ignorierte `options`-Parameter (Underscore-Prefix `_options`) → "Entpacken nach..." zeigte Datei-Speichern statt Ordner-Auswahl. Fix: `options.directory` → `pick_folder()`. (7) HOCH: `extract-to` prüfte `if (dest)` (Objekt, immer truthy) und übergab Objekt statt `dest.path`. Fix: `!dest.canceled && dest.path`. (8) MITTEL: Context-Menü registrierte bei jedem Rechtsklick 2 Event-Listener die bei externem Close nie entfernt wurden → Memory-Leak. Fix: Handler in Modul-Variablen, Cleanup in `closeContextMenu()`. (9) NIEDRIG: `calculateFolderSize` Kontextmenü-Handler ohne `.catch()`. (10) NIEDRIG: `tree.js` und `search.js` hatten lokale `escapeHtml()`/`escapeAttr()` Kopien statt Import aus utils.js. Fix: Imports, lokale Methoden entfernt. 6 Lessons-Learned dokumentiert (#65-#70). |
| 91 | 2026-02-18 | v7.2.1 | feature+fix | **7 Fixes + Strategische Planung** - (1) README.md aktualisiert (Electron→Tauri v2, npm→cargo). (2) Netzwerk-Geräte-Klassifizierung: SSDP-Daten werden jetzt VOR Port/Vendor-Heuristik ausgewertet, Vendor-only Drucker-Zuordnung entfernt (Canon-Kamera≠Drucker). (3) Kontextmenü: Neues Frontend-Popup (`context-menu.js`) ersetzt den kaputten Rust-Event-Roundtrip. Positioniertes Menü mit Rand-Erkennung, ESC/Klick-außerhalb schließt. (4) Zip-Extraktion: Neuer `extract_archive` Command (PowerShell Expand-Archive), Kontextmenü-Einträge "Hier entpacken" / "Entpacken nach...". (5) Global Hotkey: `tauri-plugin-global-shortcut` v2 integriert, `set_global_hotkey` nutzt echtes Plugin-API (kein Stub mehr), gespeicherter Hotkey wird beim App-Start automatisch registriert, Fenster wird bei Tastendruck fokussiert. (6) Eigenschaften-Dialog: Ordnergröße wird jetzt asynchron via `calculateFolderSize` berechnet und mit Datei-/Ordner-Anzahl angezeigt. (7) EXE als Administrator: Neuer `run_as_admin` Command (Start-Process -Verb RunAs), Kontextmenü-Eintrag bei .exe/.msi-Dateien. **Strategische Entscheidung:** IP-Scanner und Registry-Cleaner werden aus der App entfernt (AV-Risiko in Firmenumgebungen). Produktstrategie Stufe 2 angepasst. |
| 90 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit Runde 6: TypeError + Delete-Bestätigung + escapeHtml-Konsolidierung** - (1) HOCH: `old-files.js` und `duplicates.js` riefen `.filter()` auf dem Rückgabewert von `deleteToTrash()` auf — aber der gibt ein einzelnes Objekt `{success:true}` zurück, kein Array → TypeError beim Löschen. Fix: Rückgabe korrekt als Objekt behandelt. (2) HOCH: Explorer Delete-Taste und Shift+Delete löschten ohne Bestätigungsdialog — Verstoß gegen CLAUDE.md-Regel für destruktive Operationen. Fix: `showConfirmDialog` vor dem Löschen eingefügt. (3) MITTEL: 5 Views hatten duplizierte `esc()` Methoden statt zentraler `escapeHtml()` aus utils.js (cleanup.js, old-files.js, duplicates.js, registry.js, explorer.js). Fix: `escapeHtml` importiert, lokale Implementierungen durch Delegation ersetzt. |
| 89 | 2026-02-17 | v7.2.1 | fix | **Kritischer Fix: withGlobalTauri + ES-Module Cascade Failure** - (1) KRITISCH: `withGlobalTauri: false` in tauri.conf.json (gesetzt durch Security-Audit) verhinderte dass `window.__TAURI__` existiert → Bridge-IIFE brach sofort ab → `window.api` wurde nie erstellt → gesamtes Frontend tot (Burger-Menü, Sidebar, Tabs, alle Funktionen). Fix: Zurück auf `true`, Zugriffskontrolle über Capabilities. (2) HOCH: NetworkView-Constructor griff ohne optional chaining auf `window.api.onNetworkScanProgress` und `window.api.getPreferences` zu → TypeError auf Module-Level killte gesamte app.js. Fix: `window.api?.` optional chaining. (3) HOCH: app.js Module-Level `window.api.onOpenEmbeddedTerminal` ohne optional chaining → gleicher Cascade-Failure. Fix: `window.api?.` optional chaining. (4) MITTEL: `showConfirmDialog` Rückgabewert-Bug in network.js — `!confirmDel` prüfte Objekt `{response:0}` als Boolean (immer truthy) → Lösch-Bestätigung nie blockiert. Fix: `!confirmDel?.response`. (5) CLAUDE.md korrigiert: Falsche Regel "withGlobalTauri MUSS false sein" durch korrekte Anweisung ersetzt. 3 Lessons-Learned dokumentiert (#62-#64). |
| 88 | 2026-02-17 | v7.2.1 | fix | **Bridge-Audit: menu-action Listener + Methodenzähler** - (1) Fehlender `onMenuAction` Listener in tauri-bridge.js: Backend emittierte `"menu-action"` für den "Über Speicher Analyse"-Menüeintrag, aber die Bridge hatte keinen Listener dafür. Klick ging ins Leere. Fix: Listener in Bridge + Handler in app.js ergänzt. (2) Methodenzähler in console.log war veraltet (148/20 statt 149/22). 1 Lesson-Learned dokumentiert (#61). |
| 87 | 2026-02-17 | v7.2.1 | fix | **Frontend-Audit: 39 Bugs analysiert, 15+ Fixes implementiert** - (1) HOCH: `tabLoaded` in app.js wurde VOR erfolgreichem `await`-Call gesetzt — bei API-Fehler konnte der Tab nie neu geladen werden. Fix: Alle 11 Fälle umgestellt (Flag erst NACH `await`), try-catch ergänzt. (2) HOCH: preview.js hatte lokale `escapeHtml()` die `'` nicht escaped — XSS-Risiko. Fix: Importierte `escapeHtml()` aus utils.js verwendet. (3) HOCH: `sanitizeHtml()` prüfte `javascript:` case-sensitive — Mixed-Case umging den Check. Fix: Redundanten ersten Check entfernt, case-insensitiver Check (Zeile 598) greift. (4) MITTEL: 10 Dateien hatten lokale `_esc()` Duplikate statt zentraler `escapeHtml()` aus utils.js (Regelverletzung). Fix: Alle 10 Dateien bereinigt — Import ergänzt, `this._esc()` durch `escapeHtml()` ersetzt, lokale Definition entfernt. (5) MITTEL: `confirm()` in network.js (2x) durch `window.api.showConfirmDialog()` ersetzt (konsistente UX). (6) NIEDRIG: 5 Umlaut-Fehler behoben ("Grösse"→"Größe", "Verschleiss"→"Verschleiß", "anschliessen"→"anschließen", "schliessen"→"schließen"). 4 Lessons-Learned dokumentiert (#57-#60). |
| 86 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit Runde 5: 2 Bugs in Privacy + Netzwerk-Export** - (1) diagnose-toast: `recommendedValue` in `build_privacy_settings` war `0`, aber `privacy_setting_lookup` verwendete `recommended: 1`. Nach Anwenden zeigte die UI dauerhaft "nicht privat", weil Anzeige gegen falschen Wert prüfte. Fix: `recommendedValue` auf `1` korrigiert. (2) export_network_history CSV: Felder `connections`, `bandwidthRx`, `bandwidthTx` existierten nicht in der Snapshot-Struktur — CSV-Export produzierte nur Nullen. Fix: CSV liest jetzt korrekte Felder aus `data.summary` (totalConnections, establishedCount, listeningCount, udpCount) und Prozessanzahl aus `grouped`. 2 Lessons-Learned dokumentiert (#55-#56). |
| 85 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit Runde 4: 7 Bugs in ps.rs, oui.rs, scan.rs** - (1) ps.rs: UTF-8 Panic in `script_preview()` und `run_ps_json()` — Byte-Slicing `&str[..120]` kann bei Multi-Byte-Zeichen (Umlaute) in der Mitte schneiden → Panic. Fix: `is_char_boundary()` für sichere Truncation. (2) oui.rs: 3 fehlerhafte OUI-Prefixes — Juniper 7-stellig, Synology 7-stellig, QNAP mit Doppelpunkten — matchen nie weil lookup() nur 6-stellige Hex-Strings vergleicht. Fix: Korrigiert/entfernt. (3) oui.rs: `h.contains("tv")` klassifiziert Hostnamen wie "entwickler-pc" fälschlich als Smart-TV. Fix: Spezifischere Patterns (`-tv`, `tv-`, `smart-tv`). (4) scan.rs: `normalize_dir_key` ohne Case-Normalisierung — Windows ist case-insensitive, Index-Lookup scheitert bei unterschiedlicher Groß/Kleinschreibung. Fix: `.to_lowercase()`. (5) scan.rs: CSV-Export hatte überflüssiges Trailing-Semikolon. (6) scan.rs: `file_count` war inkonsistent (Root=own, Kinder=total). Fix: Einheitlich `total_file_count`. (7) oui.rs: `is_tracker()` Pattern `.analytics.` und `.facebook.com/tr` zu breit — spezifischere Patterns. 6 Lessons-Learned dokumentiert (#49-#54). |
| 84 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit Runde 3: 8 Security/Funktions-Bugs gefixt** - (1) disable_scheduled_task: Wildcard `-TaskName '*'` deaktivierte ALLE Tasks in einem Pfad — könnte kritische System-Tasks abschalten. Fix: `task_name` Pflichtparameter, Frontend sendet `path` und `name` getrennt. (2) uninstall_bloatware: Meldete `success: true` auch wenn `packageFullName` fehlte und nichts passierte. Fix: Err() bei fehlendem Pflichtfeld. (3) open_with_dialog: Dateinamen mit `"` nicht escaped → Command Injection möglich. Fix: `"` → `` `" ``. (4) terminal_destroy: `child.kill()` + `child.wait()` blockierten Tokio-Runtime unter Mutex. Fix: Session aus Mutex entfernen, dann kill+wait in `spawn_blocking`. (5) get_update_history: COM-Objekt-Aufruf ohne try/catch — bei fehlendem Windows-Update-Service crash. Fix: try/catch mit leerem Array-Fallback. (6) deep_search_start: `use_regex` Parameter war ignoriert. Fix: `-match` (Regex) vs. `-like` (Wildcard) Umschaltung. (7) Git Bash: Hardcoded Pfad `C:\Program Files\Git\...`. Fix: `find_git_bash()` sucht dynamisch via `where git`. (8) terminal_create: Spawn-Fehler gab `Ok({id: null})` zurück statt `Err()`. 8 Lessons-Learned dokumentiert (#41-#48). |
| 83 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit Runde 2: 8 weitere Bugs gefixt** - (1) correlate_software: Falscher Feldname `displayName` statt `name` — Software-Korrelation schlug fehl weil audit_software das Feld `name` liefert. Fix: Fallback auf beide Feldnamen. (2) get_connection_diff: `removed`-Array war hardcoded leer — geschlossene Verbindungen wurden nie erkannt. Fix: Prev vs Current Vergleich mit HashSet (O(1) statt O(n*m)). (3) get_system_profile: `partitions=0` hardcoded — echte Partitionsanzahl per `Get-Disk`. (4) Blocking I/O in 4 Network-Recording-Funktionen: `std::fs` blockierte Tokio-Runtime → `tokio::fs` + `spawn_blocking`. Mutex-Logik entkoppelt (Lock nur für State, I/O außerhalb). (5) get_network_summary: `.Count` auf leerer Pipeline → `@(pipeline).Count` für null-Schutz. (6) list_network_recordings: Gesamte Datei in RAM geladen nur für Header/Footer → BufReader liest nur erste/letzte Zeile. (7) resolve_ips: Inkonsistentes Caching (leere Companies nur in Background gecached) → beide Pfade cachen jetzt konsistent. (8) get_bandwidth/get_polling_data Race Condition: Gleichzeitige Aufrufe überschrieben gegenseitig Prev-Werte → separate Store-Keys mit Prefix `bw_`/`poll_`. 8 Lessons-Learned dokumentiert (#33-#40). |
| 82 | 2026-02-17 | v7.2.1 | fix | **Tiefenaudit: 18+ Bugs gefixt (Netzwerk, Terminal, Security, Privacy, Frontend)** - Ergebnis einer vollständigen Code-Analyse (88 Bugs identifiziert, kritischste behoben): (1) Netzwerk: classify_device() gibt jetzt dynamische Labels mit Herstellernamen zurück ("Brother Drucker" statt "Drucker"), friendlyName/modelName bevorzugt. ARP-Race-Condition in beiden Scan-Funktionen behoben (zweite ARP-Lesung nach Ping-Sweep). Firmen endlich sichtbar durch zweiten Refresh nach 12s. OUI-Datenbank wird beim ersten Active-Scan automatisch heruntergeladen. SMB-Shares Fallback auf net view. detect_os Byte-Index-Bug gefixt. (2) Terminal: UTF-8-Encoding wird nach Shell-Spawn automatisch gesetzt (PowerShell: OutputEncoding+InputEncoding, CMD: chcp 65001). terminal_open_external mit Fallback auf cmd.exe. (3) Security: withGlobalTauri auf false gesetzt, Context-Menu Event-Name synchronisiert, resolve_ips mit IP-Validierung. (4) Privacy: REG_SZ statt REG_DWORD für CapabilityAccessManager-Settings. Autostart RunOnce-Substring-Match behoben. Umlaute in PowerShell-Strings korrigiert. (5) Frontend: destroy() in 5 Views ergänzt (Memory-Leak-Prävention), preview.js escapeHtml um Quote-Escaping erweitert, MAC-Fallback in passivem Scan. 32 Lessons-Learned dokumentiert. |
| 81 | 2026-02-17 | v7.2.1 | improve | **Netzwerkscan: Dynamische OUI-Datenbank, SSH/HTTP-Banner, OS-Erkennung** - Umfassende Erweiterung des aktiven Netzwerk-Scans: (1) Dynamische OUI-Datenbank: Die heruntergeladene IEEE oui.txt (~30.000+ Einträge) wird jetzt beim App-Start und nach jedem Download automatisch in den Speicher geladen — vorher lag die Datei ungenutzt auf der Festplatte, nur die statische Tabelle mit ~200 Einträgen wurde verwendet. (2) Erweiterte SSDP/UPnP-Erkennung: Doppelter M-SEARCH (Retry für UDP-Zuverlässigkeit), 5s statt 4s Empfangsfenster, neue XML-Felder extrahiert (modelNumber, serialNumber, modelDescription), SSDP SERVER-Header wird für OS-Erkennung gespeichert. (3) SSH-Banner-Grabbing: Parallele TCP-Verbindung zu Port 22 liest den SSH-Versions-Banner (z.B. "SSH-2.0-OpenSSH_8.9p1 Ubuntu-3") — identifiziert OS und SSH-Version. (4) HTTP-Server-Header: HEAD-Request an Port 80 liest den Server-Header (z.B. "nginx", "Apache", "MikroTik") für Geräte-Identifikation. (5) TTL-basierte OS-Erkennung: Ping-TTL wird erfasst und ausgewertet (64=Linux/macOS, 128=Windows, 255=Netzwerkgerät), kombiniert mit SSDP-SERVER und SSH-Banner für bestmögliche OS-Bestimmung. (6) Alle 6 fehlenden Frontend-Felder werden jetzt befüllt: os, firmwareVersion, serialNumber, sshBanner, httpServer, identifiedBy (erweitert um SSH/HTTP). Neue CSS-Badges für OS und HTTP-Server im Frontend. |
| 80 | 2026-02-17 | v7.2.1 | fix | **4 Migrations-Fixes: Performance, PDF-Anzeige, Terminal, Explorer-Icons** - (1) Performance-Optimierung: Verzeichnis-Index (DirIndexEntry HashMap) ermöglicht O(1)-Zugriff auf Ordnergrößen statt O(N)-Scan aller Dateien bei jedem Verzeichniswechsel. Bincode-Serialisierung (5-10x schneller als JSON) für Scan-Daten-Persistenz mit automatischer JSON→bincode Migration. Verzeichniswechsel von 2-3 Sekunden auf unter 50ms. (2) PDF/DOCX/XLSX-Anzeige repariert: Base64-Dekodierung fehlte — Tauri serialisiert Binärdaten als Base64-Strings (Electron konnte ArrayBuffers direkt übergeben). atob() + charCode-Schleife in preview.js für alle 3 Formate. (3) Terminal repariert: stdout/stderr wurden nie gelesen (piped I/O ohne Reader-Threads), Shell-Feldnamen passten nicht (Backend: "name", Frontend: "label"+"available"). Background-Threads für stdout/stderr mit app.emit("terminal-data"/"terminal-exit"). (4) Explorer: SVG-Dateityp-Icons mit 15 Typen (PDF rot, Ordner gelb, Code grün, Bilder lila, etc.) und ~80 Dateiendungs-Zuordnungen ersetzen die generischen Emoji-Icons. Farbkodierung per CSS-Klassen. |
| 79 | 2026-02-17 | v7.2.1 | fix | **Scan-Persistenz, SSDP-Modell-Erkennung, 3 weitere Fixes** - (1) Speicher-Scan-Daten werden jetzt auf Disk persistiert (`scan-meta.json` + `scan-data.json` in %APPDATA%/speicher-analyse/) — beim Neustart lädt `getRestoredSession` die Daten automatisch in den Memory-Store zurück, sodass Tree, Charts und alle Abfragen sofort funktionieren ohne erneuten Scan. (2) Netzwerk-Scan um SSDP/UPnP-Modell-Erkennung erweitert (Phase 3): M-SEARCH Multicast an 239.255.255.250:1900, XML-Device-Descriptions werden heruntergeladen und modelName/manufacturer/friendlyName extrahiert — Geräte wie "Fritz!Box 7590" werden jetzt mit echtem Modellnamen angezeigt statt nur "Router/Gateway". (3) Netzwerk-Scan-Daten ebenfalls auf Disk persistiert (`last-network-scan.json`), werden beim Neustart aus der Datei geladen. (4) `deep_search_cancel` komplett neu: Speichert PID des PowerShell-Prozesses und beendet ihn per `taskkill /PID /T /F` — vorher lief der Prozess nach "Abbrechen" im Hintergrund weiter. (5) `terminal_resize` korrekterweise als Stub markiert (`stub: true` statt irreführendem `success: true`). (6) Verzeichnis-Anzeige nach Scan flüssiger: `loadAllViews` lädt Tree sofort (nicht-blockierend), Charts und Top-Dateien parallel via `Promise.allSettled`. |
| 78 | 2026-02-17 | v7.2.1 | fix | **Tiefenanalyse: 2 Netzwerk-Bugs behoben** - (1) Firmen-Zuordnung in der Detail-Ansicht fehlte: `get_polling_data` setzte `resolved.org` für jede einzelne Verbindung auf leer, obwohl die Firma im IP-Resolve-Cache vorhanden war. Die Firma wurde nur auf Gruppen-Ebene (`resolvedCompanies`) gemappt, nicht auf die einzelnen Verbindungen zurückgeschrieben. Fix: `IP_RESOLVE_CACHE` wird jetzt bereits beim Bauen der Verbindungsliste ausgelesen und pro Verbindung in `resolved.org` geschrieben — die Firma erscheint jetzt in der Verbindungs-Tabelle. (2) Port-Scan (`scan_device_ports`) meldete fälschlich Ports als "offen": Die PowerShell-Prüfung verwendete nur `$t.task.IsCompleted -and -not $t.task.IsFaulted`, prüfte aber nicht `$t.client.Connected`. Dadurch wurden Ports als offen gemeldet auch wenn die Verbindung abgelehnt wurde. Fix: `$t.client.Connected` zur Prüfung hinzugefügt (konsistent mit `scan_network_active`). Tiefenanalyse aller Scan-Funktionen: Disk-Scan, Duplikat-Scan, Security-Audit (12 Prüfungen), Registry-Scan, Cleanup, Session-Restore, Netzwerk-Aufzeichnung/Snapshots — alle verifiziert und funktionsfähig. OUI-Modul (220 Hersteller), Geräteklassifizierung (Ports + Hostname + Vendor), IP→Firma-Auflösung (50+ Firmen), Tracker-Erkennung — vollständig integriert. Keine verbleibenden Stubs gefunden. |
| 77 | 2026-02-16 | v7.2.1 | fix | **31 Stubs durch echte Implementierungen ersetzt** - Alle nach der Tauri v2 Migration fehlenden Funktionen implementiert: (1) Session-Restore liest jetzt gespeicherte Session-Daten zurück (war immer null). (2) Sicherheitscheck von 3 auf 12 Prüfungen erweitert (Defender-Echtzeitschutz, Virendefinitionen-Alter, Windows-Updates, BitLocker, SMBv1, Remotedesktop, Passwort-Richtlinie, Secure Boot, Autostart-Anzahl). (3) Audit-History wird in audit-history.json persistiert (max. 20 Einträge). (4) Netzwerk-Aufzeichnung komplett implementiert — Start/Stop mit JSONL-Dateien, Events anhängen, Aufzeichnungen auflisten/löschen/Verzeichnis öffnen. (5) Netzwerk-Snapshots speichern/laden/löschen/exportieren (JSON + CSV). (6) Duplikat-Finder mit echtem Size-Based + Partial-Hash-Scan, Fortschritts-Events und Abbruch-Funktion. (7) Admin-Elevation über PowerShell Start-Process -Verb RunAs. (8) Terminal: Dynamische Shell-Erkennung (PowerShell 7, Windows PowerShell, CMD, Git Bash, WSL), Session-Verwaltung mit Piped I/O. (9) Software-Korrelation findet zugehörige Dateien, Registry-Keys und Services. (10) Software-Updates via winget upgrade. (11) Registry-Backup-Wiederherstellung listet vorhandene Backups. (12) Screenshot via System.Drawing. (13) Datenschutz-Empfehlungen erkennen telemetrielastige Programme. (14) OUI-Datenbank-Download via IEEE. |
| 76 | 2026-02-16 | v7.2.1 | feature | **Netzwerk-Informationen wiederhergestellt** - Fehlende Netzwerk-Daten nach der Tauri v2 Migration komplett wiederhergestellt: (1) Neues OUI-Modul (`oui.rs`) mit ~220 MAC-Herstellerpräfixen für Offline-Herstellererkennung (Apple, Samsung, TP-Link, Netgear, etc.). (2) Aktiver Netzwerk-Scan (`scan_network_active`) um paralleles Port-Scanning (11 Ports) und Rust-seitige Geräteklassifizierung erweitert — jedes Gerät erhält Hersteller, Gerätetyp, Label und Icon basierend auf offenen Ports, Hostname und MAC-Adresse. (3) IP-Auflösung (`resolve_ips`) vollständig implementiert — parallele Reverse-DNS-Auflösung mit Zuordnung zu ~50 Firmen (Google, Microsoft, Apple, Meta, AWS, Deutsche Telekom, Vodafone, etc.) und Tracker-Erkennung. (4) Polling-Daten (`get_polling_data`) mit Firmen-Zuordnung über einen Hintergrund-Cache — aufgelöste IPs werden gecacht und bei jedem Poll-Zyklus in die Prozessgruppen eingebettet. (5) Passiver Scan (`scan_local_network`) um OUI-Herstellerzuordnung und korrekte Feldnamen erweitert. (6) Explorer: Silent-Catch bei Ordnergrößen durch geloggte Warnung ersetzt. |

---

## Lessons Learned

Siehe auch: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (3 Lessons)
Siehe auch: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md)

### #9: Migration = JEDE Funktion prüfen, nicht nur die offensichtlich kaputten (2026-02-16)

**Problem:** Nach der Electron→Tauri v2 Migration wurden 31 Funktionen als Stubs belassen (leere Arrays, `null`, `{ stub: true }`). Die KI hat nur die offensichtlich sichtbaren Probleme (Netzwerk-Scan) repariert und die restlichen 31 Stubs ignoriert. Der User musste mehrmals darauf hinweisen, dass Funktionen fehlen — obwohl eine systematische Prüfung ALLER Commands beim ersten Mal nötig gewesen wäre.

**Ursache:** Isolierte statt ganzheitliche Analyse. Die KI hat sich auf ein Symptom konzentriert (Netzwerk zeigt keine Daten) statt die gesamte Codebasis systematisch zu prüfen (welche Commands sind Stubs? welche geben Fake-Daten zurück?).

**Lösung:** Nach JEDER Migration/Rewrite: Systematisch JEDEN Command in commands.rs durchgehen und per Grep nach Stub-Patterns suchen (`stub: true`, `json!([])`, `json!(null)`, `"not implemented"`). Checkliste abarbeiten, nicht nur die ersten sichtbaren Fehler fixen.

**Lehre:**
- Migration ist NICHT fertig wenn die App startet. Migration ist fertig wenn JEDE Funktion echte Daten liefert.
- NIEMALS isoliert analysieren. IMMER die gesamte Codebasis prüfen.
- Ein Stub der `[]` oder `null` zurückgibt ist genauso kaputt wie ein Kompilierungsfehler — er ist nur schwerer zu sehen.
- Der User muss NIEMALS zweimal auf dasselbe Problem hinweisen. Beim ersten Hinweis: ganzheitlich prüfen, nicht nur den gemeldeten Fall fixen.
- Grep-Patterns für Stub-Erkennung: `stub: true`, `json!([])`, `json!(null)`, `"not implemented"`, `"not yet"`, `todo!()`, `unimplemented!()`



> Electron-Ära Lessons (#1-#8) wurden in [`docs/lessons-learned/lessons-learned.md`](../../lessons-learned/lessons-learned.md) archiviert (Kategorien: Allgemein, Migration).
