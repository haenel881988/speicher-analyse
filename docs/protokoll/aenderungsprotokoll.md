# Änderungsprotokoll

> **Regel:** Maximal 30 Einträge. Bei Überschreitung die ältesten in `archiv/` verschieben (Dateiname: `aenderungsprotokoll_<version>.md`).

Archiv: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (30 Einträge, v7.0–v7.2)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md) (15 Einträge, v7.3–v7.5)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v8.0.md`](archiv/aenderungsprotokoll_v7.3-v8.0.md) (15 Einträge, v7.3–v8.0)
Archiv: [`archiv/aenderungsprotokoll_v7.2.1-v7.3.md`](archiv/aenderungsprotokoll_v7.2.1-v7.3.md) (15 Einträge, v7.2.1–v7.3)

---

| # | Datum | Version | Typ | Beschreibung |
|---|-------|---------|-----|-------------|
| 58 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Klassifizierung: 3 Schwachstellen für Fremdnetzwerke behoben** - (1) Port 445 (SMB) wird nicht mehr allein als Windows-Signal gewertet — NAS-Geräte (Buffalo, WD, Samba-Server) haben auch SMB offen und wurden fälschlich als "Windows PC" klassifiziert. Jetzt nur noch als Windows wenn zusätzlich Port 135 (RPC) oder 3389 (RDP) offen ist, die wirklich Windows-exklusiv sind. (2) Hostname-Erkennung für "nas" und "brn" (Brother-Drucker) von Substring-Suche auf Wortgrenzen umgestellt — "gymnasium", "nasty-pc" oder "auburn-server" werden nicht mehr fälschlich als NAS bzw. Drucker erkannt. (3) Port 515 (LPD) wird jetzt nur als Drucker gewertet wenn zusätzlich ein reiner Drucker-Hersteller erkannt wurde (HP, Brother, Kyocera, Lexmark, Konica Minolta, Ricoh, Xerox) — Industriegeräte oder IoT-Geräte mit Port 515 werden nicht mehr fälschlich als Drucker angezeigt. Alle Fixes per Puppeteer-Screenshot verifiziert: 11 Geräte korrekt klassifiziert, keine Regression. |
| 57 | 2026-02-14 | v7.2.1 | improve | **Netzwerk-Klassifizierung: Multi-Produkt-Hersteller aus Erkennung entfernt** - 18 Hersteller die verschiedene Gerätetypen produzieren (Canon, Samsung, Apple, Sony, Amazon, Google, LG, Huawei, Xiaomi, Cisco, TP-Link, D-Link, Netgear, Edimax, Ubiquiti, Western Digital, Seagate, Buffalo) wurden aus der automatischen Typ-Zuordnung entfernt. Bisher wurde z.B. jedes Samsung-Gerät als "Mobilgerät" eingestuft, obwohl Samsung auch TVs und Haushaltsgeräte baut. Jetzt werden nur noch Hersteller zugeordnet die wirklich nur einen Gerätetyp im Netzwerk haben (z.B. Synology = NAS, Sonos = Lautsprecher, Hikvision = Kamera). Geräte von Multi-Produkt-Herstellern ohne eindeutige Erkennung (Identity, Ports, Hostname) werden ehrlich als "Unbekanntes Gerät" angezeigt — der Herstellername bleibt sichtbar, bestimmt aber nicht mehr den Typ. Gleiches Prinzip auch bei der NAS-Vendor-Bestätigung (nur noch Synology + QNAP) und beim Apple-Sonderfall im OS-Fallback (entfernt, da Apple iPhones, MacBooks, Apple TV und HomePod baut). Per Puppeteer-Screenshot verifiziert: Visionscape-Gerät jetzt korrekt als "Unbekanntes Gerät" statt "Drucker". |
| 56 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Klassifizierung: 7 Fehlregeln im Tiefenaudit korrigiert** - Systematische Prüfung aller Klassifizierungsregeln auf Fehlpotenzial in fremden Netzwerken. (1) Port 515 (LPD) nicht mehr drucker-exklusiv — ein Visionscape-Industriegerät wurde fälschlich als Drucker angezeigt obwohl nur ein HP-Drucker existiert. (2) Port 554 (RTSP) nicht mehr kamera-exklusiv — Smart TVs und Media Streamer nutzen RTSP ebenfalls; nur noch mit bestätigtem Kamera-Hersteller. (3) Port 631 (IPP) nur noch als Drucker wenn keine Server-Ports (SSH, HTTP+SMB) gleichzeitig offen — Linux-Server mit CUPS nicht mehr als Drucker. (4) Hostname-Regel 'cam' von Substring auf Wortgrenze geändert — "cambridge-pc" wurde fälschlich als Kamera erkannt. (5) mDNS-Regel '_smb._tcp' aus NAS-Zuordnung entfernt — jeder Windows-PC mit Dateifreigabe wurde als NAS klassifiziert. (6) mDNS-Regeln '_rdp/_vnc' von ungültigem Typ 'computer' auf gültiges 'pc' korrigiert. (7) Linux/macOS-Fallback: Geräte mit TTL 64 ohne SSH werden jetzt als "Unbekanntes Gerät" angezeigt statt "Linux/macOS Gerät" — viele IoT-Geräte haben Linux-Firmware und wurden falsch eingestuft. Alle Fixes per Puppeteer-Screenshot visuell verifiziert: 11 Geräte, jedes korrekt klassifiziert, nur noch ein Drucker (HP). |
| 55 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Geräte-Erkennung: 3 Fehlklassifizierungen behoben** - (1) Port 515 (LPD) wird jetzt als drucker-exklusives Protokoll behandelt — ein Gerät mit Port 515 wird immer als Drucker erkannt, nicht mehr als "Linux/macOS Gerät". (2) Geräte mit lokal-administrierter MAC-Adresse (Bit 1 gesetzt, typisch für Smartphones mit MAC-Randomisierung) und ohne Vendor, Ports oder Hostname werden jetzt als "Unbekanntes Gerät" klassifiziert statt fälschlich als "Linux/macOS Gerät". (3) HTTP-Banner-Parsing filtert jetzt extrahierte Modellnamen nochmals gegen generische Begriffe ("Welcome", "Configurator", "Login" etc.) — dadurch erscheint beim Zyxel-Router nicht mehr "Welcome to the Web-Based" als Modellname. Alle 3 Fixes per Puppeteer-Screenshot visuell verifiziert. |
| 54 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Geräte-Erkennung: 40 Wurzelursachen in 8 Phasen behoben** - Komplette Überarbeitung der Geräte-Erkennung in 4 Schichten (Discovery, Identifizierung, Klassifizierung, Darstellung). Phase 1: Synthetische Modellnamen entfernt — Geräte zeigen jetzt "—" statt erfundener Namen wie "NAS synth" oder "Netzwerkdrucker synth". Neues isConfirmed-Feld unterscheidet bestätigte von unbestätigten Geräten, identifiedBy nur noch als Tooltip-Icon. Phase 2: Port-basierte Klassifizierung repariert — Port 515 allein macht kein Gerät mehr zum Drucker (nur mit Drucker-Vendor oder Port 631), Port 5000 allein macht kein Gerät mehr zum NAS (nur mit NAS-Vendor oder beide 5000+5001), Port 9100+80 wird jetzt korrekt als Drucker erkannt. 3 neue Scan-Ports (5900/VNC, 8554/RTSP, 37777/Dahua). Phase 3: "Eigener PC" heisst jetzt "PC / Laptop" und wird korrekt gruppiert, MAC-Adresse des eigenen PCs via WMI, IP-Sortierung numerisch statt lexikographisch, Badge-Klick scrollt korrekt, leere Ports zeigen "—", kein Double-Render beim Filtern. Phase 4: Smartphones und IoT-Geräte die nicht auf Ping antworten werden jetzt über die ARP-Tabelle gefunden. Phase 5: HTTP-Banner-Parsing erkennt jetzt auch "ZyXEL VMG3625 Login" (ohne Trennzeichen), deutsche Router-UIs ("Anmeldung", "Konfiguration"), und Meta-Tags in beiden Attribut-Reihenfolgen. Phase 6: Samsung, Apple, Huawei, Amazon, Google, Ring als Vendor-Patterns ergänzt, Sony Interactive vor Sony (PlayStation nicht mehr als TV), "switch" im Hostname matched nur noch Nintendo Switch. Phase 7: mDNS/WSD-Daten bleiben erhalten wenn HTTP ein Ergebnis liefert, Port 9100 nicht mehr als IPP-Target. Phase 8: Toter Code entfernt (PORT_TYPE_HINTS, ungenutzter Event-Handler), HP SNMP OID nicht mehr pauschal als Drucker. Multicast/Link-Local-Filterung verbessert. |
| 53 | 2026-02-14 | v7.2.1 | feature | **Vollständige Geräte-Erkennung + Gruppierung** - Alle Geräte im Netzwerk zeigen jetzt einen Modellnamen: (1) Eigener PC wird per WMI erkannt (echte Hardware-Daten: Hersteller + Modell). (2) Router-Login-Seiten liefern jetzt den Modellnamen, auch wenn der Titel "Login" oder "Configurator" enthält — der Modellname wird VOR dem generischen Wort extrahiert. Zusätzlich werden h1-Überschriften und Meta-Tags als Fallback geprüft. (3) Geräte die sich per DNS/mDNS selbst benennen (z.B. "XBOX.local") werden automatisch erkannt. (4) Für alle verbleibenden Geräte wird eine Beschreibung aus Hersteller, offenen Ports und Betriebssystem zusammengebaut (z.B. "Visionscape Netzwerkdrucker"). Neue Gruppierung: Geräte werden nach Typ gruppiert (Medien-Geräte, Drucker, etc.) mit ein-/ausklappbaren Gruppen-Headern. Toggle-Button wechselt zwischen gruppierter und flacher Ansicht. Klick auf die Typ-Badges oben scrollt direkt zur jeweiligen Gruppe. |
| 52 | 2026-02-14 | v7.2.1 | feature | **WSD-Scanner, mDNS ohne Firewall-Eingriffe, Layout-Fix** - Drei Verbesserungen für den Netzwerk-Scanner: (1) Neuer WSD-Scanner (Web Services Discovery) erkennt Windows-PCs, Drucker und Scanner ohne Firewall-Änderungen — nutzt Multicast-Probe mit Unicast-Antwort, die von jeder Stateful Firewall automatisch durchgelassen wird. (2) mDNS/Bonjour arbeitet jetzt als stiller Best-Effort — kein Versuch mehr, Windows-Firewall-Regeln zu erstellen. Funktioniert wenn Bonjour installiert ist, sonst 0 Ergebnisse ohne Fehlermeldung. (3) HTTP-Probing um 12 Router/NAS-Hersteller erweitert (Zyxel, TP-Link, Netgear, ASUS, Synology, QNAP, MikroTik, Ubiquiti u.a.). Zusätzlich: Sidebar-Layout-Bug behoben — eine fehlerhafte CSS-Regel machte die Sidebar 240px breit bei Fenstern unter 900px, obwohl nur 56px Icons angezeigt wurden. Dadurch ging fast ein Drittel der Fensterbreite verloren. |
| 51 | 2026-02-14 | v7.2.1 | feature | **Erweiterte Geräte-Erkennung im Netzwerk-Scanner** - Drei neue Erkennungsmethoden: (1) SNMP v2c fragt Router, Switches und Drucker nach Modellname, Firmware-Version, Seriennummer und Standort. (2) SSH Banner Grabbing erkennt das Betriebssystem von Linux-Servern und NAS-Geräten über die SSH-Versionsantwort. (3) mDNS/Bonjour entdeckt alle Netzwerk-Services dynamisch per DNS-SD Meta-Query — das Netzwerk meldet selbst welche Dienste verfügbar sind, keine vordefinierte Liste. Neue Badges in der Geräte-Tabelle zeigen Firmware (FW), Seriennummer (S/N), SSH-Version, mDNS-Services und SNMP-Gerätename. CSV-Export um alle neuen Felder erweitert. Klassifizierung nutzt die erkannten Service-Typen zur besseren Gerätetyp-Zuordnung (z.B. Google Cast = Smart TV, nicht mehr Drucker). |
| 50 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Monitor: Geräte-Klassifizierung komplett überarbeitet** - Geräte wurden anhand des Hersteller-Namens einem Typ zugeordnet (z.B. Canon = Drucker), obwohl Canon auch Kameras herstellt. Dadurch wurde z.B. der Router als Drucker angezeigt. Jetzt werden Geräte anhand ihres tatsächlichen Verhaltens erkannt: UPnP-Beschreibung (das Gerät sagt was es ist), IPP-Antwort (nur echte Drucker antworten) und Modellname-Erkennung (z.B. "FritzBox" = Router). Die alte Hersteller-Zuordnung dient nur noch als letzter Fallback. Zusätzlich: Anti-Pattern-Regel in CLAUDE.md ergänzt um solche statischen Zuordnungen künftig zu verhindern. |
| 49 | 2026-02-13 | v7.2.1 | fix | **WCAG-Kontrast: Strukturelle Lösung — Farbsystem an der Wurzel gefixt** - Statt einzelne Stellen zu reparieren, wurden die Grundfarben (--text-muted, --text-secondary) selbst verstärkt. Alle 66 Stellen die diese Farben verwenden, sind jetzt automatisch WCAG-konform. Zusätzlich: Weisse Schrift auf farbigen Badges (Risiko, Schweregrad, Status) durch schwarze Schrift ersetzt. Screenshot-Funktion für automatische Tests eingebaut (Electron-native statt Puppeteer). Neues WCAG-Gate-Script prüft automatisch alle 14 Views (1495 Elemente) auf Kontrastverletzungen mit korrektem Alpha-Blending. Ergebnis: 0 Verletzungen. |
| 48 | 2026-02-13 | v7.2.1 | fix | **WCAG-Kontrast: 11 Verletzungen in Optimizer und Netzwerk-Monitor behoben** - Graue Texte auf dunklem Hintergrund (Kategoriezähler, manuelle Pfade, Port-Labels, Tabellen-Überschriften, IP-Adressen) waren zu schwach — von --text-muted auf --text-secondary angehoben. Weisse Schrift auf roten/blauen Badges (Hoch/Niedrig) unlesbar — auf schwarze Schrift gewechselt. Lila Schrift auf halbtransparenten Netzwerk-Badges (Tab-Zähler, Seriennummern, Lokal-Badge) schlecht lesbar — auf --text-primary gewechselt. Erstmals mit echtem Browser-Test verifiziert (Puppeteer + getComputedStyle auf gerenderten Elementen), nicht nur mathematisch mit CSS-Variablen. Neue Skills /visual-verify und /test-issue erstellt, CLAUDE.md Skill-First-Direktive verschärft. |
| 47 | 2026-02-13 | v7.2.1 | fix | **Netzwerk-Monitor: Geräte mit Port 515 (LPD) als Drucker erkannt** - Ein Gerät mit nur Port 515 (LPD = Line Printer Daemon) wurde fälschlich als "Linux/macOS Gerät" angezeigt statt als Drucker. Ursache: Port 515 allein galt als "zu schwaches Signal" für die Drucker-Erkennung. Aber LPD ist ein reines Druckerprotokoll — kein normaler PC hat diesen Port offen. Der Gerätetyp-Erkennungsalgorithmus stuft Port 515 jetzt als eigenständiges Drucker-Signal ein. Per Puppeteer-Screenshot vorher/nachher verifiziert. |
| 46 | 2026-02-13 | v7.2.1 | fix | **Netzwerk-Monitor: 7 UI/UX-Verbesserungen** - (1) Top-Prozesse zeigten PIDs statt Namen — Ursache: PowerShell-Variable `$pid` ist reserviert und kann nicht überschrieben werden, umbenannt zu `$procId`. (2) Suchfeld nur noch im Verbindungen-Tab sichtbar. (3) Besserer Leerzustand für "Lokale Geräte" mit Erklärungstext. (4) Besserer Leerzustand für "Verlauf" mit Erklärung was Snapshots sind. (5) Idle/TimeWait-Verbindungen werden nach unten sortiert. (6) Inaktive Netzwerk-Adapter kompakt einzeilig dargestellt (z.B. "WLAN — Offline"). (7) Snapshot-Button umbenannt zu "Aktualisieren". |
| 45 | 2026-02-13 | v7.2.1 | feature | **MCP-Server — KI-Assistenten können direkt auf App-Daten zugreifen (Issue #19)** - Eigenständiger MCP-Server implementiert der lokal läuft und 10 Werkzeuge bereitstellt: Laufwerke anzeigen, gespeicherte Scan-Ergebnisse lesen (grösste Dateien, Dateitypen, Verzeichnisstruktur), aktive Netzwerk-Verbindungen mit Prozessnamen, Datenschutz-Einstellungen aus der Registry (Werbe-ID, Cortana, Telemetrie, Standort, Kamera, Mikrofon), System-Informationen (Hardware, OS, CPU, GPU), installierte Programme, Autostart-Einträge, Windows-Dienste, S.M.A.R.T. Festplatten-Gesundheit und Bereinigungsvorschläge (Temp, Cache, Downloads, Papierkorb). Server nutzt stdio-Transport und wird von Claude Code über `.mcp.json` automatisch gestartet. Keine Daten verlassen den Rechner. |
| 44 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Scanner: 5 Bugs gefixt (Datenverlust, falsche Modelle, Sonos-Erkennung)** - Tiefenanalyse des gesamten Netzwerk-Scanners: (1) Scan-Ergebnisse gingen bei jedem Seitenwechsel verloren, weil sie nur im Browser-Speicher lagen. Jetzt werden sie im Backend zwischengespeichert und automatisch wiederhergestellt. (2) Router zeigte "Welcome to the Web-Based Configurator" als Modellname — der generische Title-Filter erkannte den Text nicht, weil Sonderzeichen (::) am Anfang den Filter umgingen. Filter komplett überarbeitet: erkennt jetzt "configurator", "management", "dashboard", "web-based" u.v.m. als generische Begriffe. (3) Sonos-Geräte (5 Stück) wurden nicht per UPnP erkannt — Timeout von 4 auf 8 Sekunden erhöht, zweiter Broadcast-Typ für bessere Geräte-Abdeckung, und Port 1400 (Sonos-Webserver) zur Port-Liste hinzugefügt. (4) Port 5000 wurde immer als "Synology" angezeigt, auch beim Router — korrigiert zu "HTTP". (5) UPnP-Parser verbessert: Wenn Modellnummer vorhanden, wird diese zusammen mit dem Modellnamen angezeigt (z.B. "Sonos One (S18)"). Hersteller wird dem Modellnamen vorangestellt wenn er fehlt. |
| 43 | 2026-02-12 | v7.2.1 | feature | **Gerätemodell-Erkennung im Netzwerk-Scanner** - Der Netzwerk-Scanner erkennt jetzt nicht nur den Hersteller, sondern auch das exakte Modell, die Seriennummer und die Firmware-Version von Geräten im Netzwerk. Drei Erkennungs-Methoden arbeiten automatisch zusammen: (1) UPnP/SSDP — fragt Smart-TVs, Router und NAS per Netzwerk-Broadcast ab und liest die Gerätebeschreibung. (2) HTTP Banner — ruft die Webseite des Geräts auf (z.B. Drucker-Konfigurationsseite) und liest den Modellnamen. (3) IPP — fragt Netzwerk-Drucker direkt nach Modell und Seriennummer. Neue Spalte "Modell" in der Geräte-Tabelle, mit S/N-Badge bei vorhandener Seriennummer (Tooltip zeigt Seriennummer + Firmware). Suchfilter durchsucht auch den Modellnamen. CSV-Export enthält Modell, Seriennummer und Firmware als neue Spalten. Gesamter Scan dauert nur 5-10 Sekunden länger. |
| 42 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Scanner: Ladebalken sichtbar, Tabelle statt Kacheln, Drucker-Erkennung** - Drei Probleme behoben: (1) Der Ladebalken beim Geräte-Scan war unsichtbar — kein Spinner, kein animierter Balken, Hintergrund verschmolz mit der Seite. Jetzt zeigt ein drehender Spinner und ein pulsierender Fortschrittsbalken in jeder Scan-Phase den Fortschritt deutlich an. (2) Die grossen Geräte-Kacheln verbrauchten viel Platz ohne Mehrwert — ersetzt durch eine kompakte Tabelle (wie Advanced IP Scanner): Icon, Name, Typ, Hersteller, MAC, Ports und Ping auf einen Blick, mit Suchfilter. (3) Geräte mit Port 515 (LPD) wurden fälschlich als Drucker erkannt (z.B. "Visionscape Co., Ltd."). Jetzt wird ein Gerät nur als Drucker klassifiziert wenn Port 9100 (RAW Print) offen ist oder 631+515 zusammen — Port 515 allein reicht nicht mehr. |
| 41 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Scanner: MAC-Adressen, Ports und Geräte-Erkennung repariert** - Beim Netzwerk-Scan wurden keine MAC-Adressen, keine offenen Ports und keine Hersteller angezeigt — alle Geräte erschienen als "Linux/macOS Gerät". Ursache: Die MAC-Adressen-Abfrage und der Port-Scan liefen in einem einzigen Aufruf, der bei mehr als 10 Geräten zu langsam wurde und abgebrochen wurde (60s Limit, 72s nötig). Dadurch gingen ALLE Daten verloren. Jetzt laufen MAC-Adressen und Port-Scan getrennt — selbst wenn der Port-Scan länger braucht, bleiben MAC-Adressen und Hersteller-Erkennung erhalten. Timeout dynamisch berechnet (bis 5 Minuten). Zusätzlich: Router/Gateway wird jetzt automatisch erkannt, HP-Drucker werden am Hostnamen erkannt (z.B. "HPF94506"), und die Erkennungsreihenfolge wurde korrigiert (Hostname wird jetzt vor dem Betriebssystem-Fallback geprüft). |
| 40 | 2026-02-12 | v7.2.1 | fix | **Gerätetyp-Erkennung repariert** - Geräte im Netzwerk-Scanner wurden alle als "Unbekanntes Gerät" angezeigt, obwohl der Hersteller korrekt erkannt wurde. Ursache: Die Zuordnung Hersteller→Gerätetyp suchte nach exakt dem gleichen Namen, aber die IEEE-Datenbank liefert volle Firmennamen (z.B. "Brother Industries, Ltd." statt "Brother"). Die Erkennung arbeitet jetzt mit Teilbegriff-Suche und erkennt dadurch auch volle IEEE-Namen. 37 Hersteller-Muster erweitert (Signify/Philips Hue, Fritz!Box, Netgear, D-Link, Huawei u.a.). Fortschrittsanzeige zeigt jetzt detailliert den Fortschritt der Hersteller-Erkennung (z.B. "3 von 7 identifiziert"). |
| 39 | 2026-02-12 | v7.2.1 | improve | **Live-Hersteller-Erkennung (IEEE)** - Die Hersteller-Erkennung bei Netzwerk-Geräten fragt jetzt immer live bei der offiziellen IEEE-Registrierung nach (via macvendors.com API), statt in einer veralteten internen Liste zu suchen. Dadurch werden auch brandneue Geräte sofort korrekt erkannt. Gleiche Hersteller werden nur einmal abgefragt (Batch-Lookup). Bei fehlendem Internet greift automatisch eine Offline-Sicherheitsliste. Neue Fortschrittsphase "Hersteller-Erkennung (IEEE)" im Scanner. |
| 38 | 2026-02-12 | v7.2.1 | feature | **Netzwerk-Inventar** - Der Geräte-Scanner erkennt jetzt automatisch den Gerätetyp (PC, Drucker, NAS, Kamera, Smart-Home, Router, Server, TV, Spielkonsole etc.) anhand einer Kombination aus Hersteller, offenen Ports, Betriebssystem und Hostname. Die Hersteller-Erkennung wurde von 47 auf über 350 Hersteller erweitert und erkennt damit fast alle Geräte im Netzwerk. Statt einer Tabelle werden Geräte jetzt als übersichtliche Inventar-Karten mit farbigen Typ-Icons angezeigt. Der Port-Scan wurde um 6 zusätzliche Ports erweitert (Drucker, Kamera, NAS). CSV-Export enthält den Gerätetyp als neue Spalte. |
| 37 | 2026-02-12 | v7.2.1 | feature | **System-Profil** - Neuer Tab im Bereich System zeigt alle Informationen über den PC an einem Ort: Hersteller, Modell, Seriennummer, Betriebssystem, Prozessor, Grafikkarte, Arbeitsspeicher, Festplatten, Netzwerkadapter und direkte Links zum Hersteller-Support. 8 Info-Karten mit Kopieren- und Aktualisieren-Funktion. |
| 36 | 2026-02-12 | v7.2.1 | docs | **Produktstrategie** - Vollständige 4-Stufen-Planung in der Issue-Datei erstellt: Stufe 1 (System-Werkzeugkasten), Stufe 2 (Netzwerk & Sicherheit), Stufe 3 (IT-Dokumentation & Inventar), Stufe 4 (Fernwartung & Leichtes RMM). Alle bestehenden Issues nach Stufen zugeordnet, Zielgruppen-Mapping und empfohlene Implementierungsreihenfolge. Basiert auf der Markt- und Zielgruppenanalyse (recherche.md). |
| 35 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Monitor: Absturz beim Laden behoben** - Der Netzwerk-Monitor zeigte eine Fehlermeldung ("Maximum call stack size exceeded") beim Öffnen. Ursache: Bei der Sicherheits-Überarbeitung wurde eine Hilfsfunktion versehentlich so geschrieben, dass sie sich endlos selbst aufruft statt die Daten zu speichern. Ein-Zeilen-Fix behebt das Problem komplett. |
| 34 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Scanner: Falsches Subnetz + Sicherheits-Audit** - Der Geräte-Scanner hat das falsche Netzwerk gescannt (VPN-Interface statt echtes LAN). Ursache: Subnetz-Erkennung nutzte eine nicht-existierende Eigenschaft zum Sortieren. Fix: Subnetz wird jetzt über die Default Route (=echtes LAN-Interface mit Gateway) erkannt. Validiert: 10 Geräte im echten Netzwerk gefunden. Zusätzlich: Sicherheitsprüfung des gesamten Netzwerk-Moduls — Command-Injection-Schutz für alle Eingabefelder, IP-Validierung, Pfad-Prüfung, Cache-Begrenzung (max. 2000 IPs), Listener-Bereinigung, längere Wartezeiten bei langsamen Systemen. |
| 33 | 2026-02-12 | v7.2.1 | fix | **Netzwerk-Scanner + Monitor UI aufgeräumt** - Lokale-Geräte-Scan funktionierte nicht (Ping Sweep nutzte PowerShell 7-Befehl, der auf Windows PowerShell 5.1 nicht existiert — durch .NET Ping.SendPingAsync ersetzt). Netzwerk-Monitor von 5 auf 4 Tabs reduziert: Bandbreite und Top-Prozesse zu einer Übersichtsseite mit Statistik-Karten zusammengeführt. Header kompakter gestaltet. |
| 32 | 2026-02-12 | v7.2.1 | feature | **Netzwerk-Monitor: Grosses Upgrade** - (1) Echtzeit-Modus repariert: Statt 3 einzelner Abfragen pro Aktualisierung nur noch 1 kombinierter Aufruf, Überlappungsschutz verhindert Anfragestau, Intervall auf 10 Sekunden erhöht. (2) Neuer "Verlauf"-Tab: Netzwerk-Snapshots werden dauerhaft gespeichert (max. 200), Änderungen zwischen Snapshots werden hervorgehoben, Export als CSV oder JSON. (3) Aktiver Netzwerk-Scanner (wie Advanced IP Scanner): Erkennt alle Geräte im lokalen Netzwerk per Ping, scannt offene Ports (SSH, HTTP, RDP, SMB etc.), erkennt Betriebssystem, zeigt freigegebene Ordner, Ping-Zeiten und Hersteller. Fortschrittsanzeige während des Scans. Export als CSV. |
| 31 | 2026-02-12 | v7.2.1 | fix | **Firewall-Status falsch angezeigt** - Im Sicherheits-Check wurde die Windows-Firewall als "deaktiviert" angezeigt, obwohl sie aktiv war. Ursache: PowerShell gibt den Status als Ganzzahl (1/0) zurück, der Code erwartete aber einen anderen Datentyp. Gleiches Problem auch bei der Benutzerkonten-Prüfung behoben. |

---

## Lessons Learned

Siehe auch: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (3 Lessons)
Siehe auch: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md)

### #4: node-pty + Electron: Native Module Builds (2026-02-10)

**Problem:** node-pty@1.1.0 brauchte winpty (GetCommitHash.bat Fehler). node-pty@1.2.0-beta.11 (ConPTY-only) scheiterte an Spectre-Mitigation.

**Lösung:** `scripts/rebuild-pty.js` patcht binding.gyp automatisch vor electron-rebuild. In package.json als postinstall registriert.

**Lehre:** Native Electron-Module können plattformspezifische Build-Probleme haben. Automatische Patches als postinstall-Scripts sind robuster als manuelle Fixes.

---

### #5: Session-Save im before-quit muss synchron sein (2026-02-10)

**Problem:** Electrons `before-quit` Event wartet NICHT auf async Operationen. `await session.saveSession()` wird nie fertig.

**Lösung:** Synchrone Variante: `zlib.gzipSync()` + `fs.writeFileSync()` direkt im before-quit Handler. Die async Variante wird nur für after-scan und manuelles Speichern verwendet.

**Lehre:** Electron Lifecycle-Events (before-quit, will-quit) sind synchron. Für Cleanup-Code immer synchrone APIs verwenden.

---

### #6: Chromium file:// blockiert Module Workers (2026-02-10)

**Problem:** pdf.js Worker-Datei ist `.mjs` → pdf.js erstellt `new Worker(url, { type: 'module' })`. Chromium blockiert Module Workers von `file://` URLs (null origin, CORS-Check fehlschlägt).

**Lösung:** Worker-Script per `fetch()` laden, `export{}` Statement entfernen (ungültig in Classic Worker), als `Blob` + `URL.createObjectURL()` laden. CSP erlaubt `worker-src blob:`.

**Lehre:** In Electron (file:// Protokoll) niemals Module Workers (.mjs) verwenden. Immer Classic Workers via Blob-URL oder .js-Dateien nutzen.

---

### #7: Node.js Buffer.buffer enthält Pool-Daten (2026-02-10)

**Problem:** `fs.readFile()` gibt Buffer zurück. `buffer.buffer` ist der unterliegende ArrayBuffer, der bei kleinen Dateien den GESAMTEN Pool enthält (8KB+). `new Uint8Array(buffer.buffer)` enthält dann Müll-Daten.

**Lösung:** `buffer.buffer.slice(buffer.byteOffset, buffer.byteOffset + buffer.byteLength)` für sauberen ArrayBuffer.

**Lehre:** NIEMALS `buffer.buffer` direkt über IPC senden. Immer `.slice()` für einen sauberen ArrayBuffer verwenden.

---

### #8: Electron Admin-Elevation: Single-Instance Lock Race Condition (2026-02-11)

**Problem:** `Start-Process -Verb RunAs` startet den neuen Prozess, PowerShell gibt Return, und `app.quit()` wird aufgerufen. Aber `app.quit()` ist ASYNC — bis die alte Instanz den Lock freigibt, hat die neue Instanz bereits `requestSingleInstanceLock()` aufgerufen, `false` bekommen, und sich sofort beendet. Ergebnis: App schließt sich und nichts passiert.

**Lösung:** 4 Fixes zusammen:
1. `app.releaseSingleInstanceLock()` EXPLIZIT VOR dem Spawn der neuen Instanz aufrufen (Electron API seit v15)
2. `app.exit(0)` statt `app.quit()` — sofortiger Exit ohne async Event-Queue
3. `execFileAsync` statt `execAsync` — bypassed cmd.exe komplett (keine Double-Quote-Nesting-Probleme)
4. `app._isElevating` Flag — verhindert dass Window-Close/Tray/window-all-closed während der UAC-Wartezeit `app.quit()` aufrufen

**Lehre:**
- `app.quit()` ist ASYNC und feuert Events (before-quit, will-quit, window-all-closed). Für Elevation immer `app.exit(0)` verwenden.
- `requestSingleInstanceLock()` muss EXPLIZIT mit `releaseSingleInstanceLock()` freigegeben werden bevor die neue Instanz startet. Sich auf `app.quit()` verlassen funktioniert nicht (Race Condition).
- `exec()` geht durch `cmd.exe /c "..."` — fragile Verschachtelung bei PowerShell-Befehlen. `execFile()` spawnt direkt.
- Während Elevation (UAC-Wartezeit bis 120s) muss ALLES was `app.quit()` aufrufen könnte blockiert werden: Window-Close, window-all-closed, Tray-Menü. Sonst wird `before-quit` gefeuert, Cleanup-Code räumt die scans-Map ab, und die Elevation-Daten sind weg.
