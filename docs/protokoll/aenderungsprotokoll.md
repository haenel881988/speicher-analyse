# Änderungsprotokoll

> **Regel:** Maximal 30 Einträge. Bei Überschreitung die ältesten in `archiv/` verschieben (Dateiname: `aenderungsprotokoll_<version>.md`).

Archiv: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (30 Einträge, v7.0–v7.2)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md) (15 Einträge, v7.3–v7.5)
Archiv: [`archiv/aenderungsprotokoll_v7.3-v8.0.md`](archiv/aenderungsprotokoll_v7.3-v8.0.md) (15 Einträge, v7.3–v8.0)
Archiv: [`archiv/aenderungsprotokoll_v7.2.1-v7.3.md`](archiv/aenderungsprotokoll_v7.2.1-v7.3.md) (15 Einträge, v7.2.1–v7.3)
Archiv: [`archiv/aenderungsprotokoll_v7.2.1-n31-45.md`](archiv/aenderungsprotokoll_v7.2.1-n31-45.md) (15 Einträge, #31–#45)

---

| # | Datum | Version | Typ | Beschreibung |
|---|-------|---------|-----|-------------|
| 70 | 2026-02-15 | v7.2.1 | feature | **Netzwerk-Monitor: 9 Optimierungen** - Umfassende Erweiterung des Netzwerk-Moduls: (1) Persistenter IP-Cache: Aufgelöste IP-Informationen werden in %APPDATA% gespeichert und beim nächsten Start sofort geladen (TTL: 7 Tage, max. 2000 Einträge). (2) Lokale OUI-Datenbank: Hersteller-Erkennung nutzt jetzt eine lokale IEEE-Datenbank mit 38.902 Einträgen statt einer externen API — Netzwerk-Scan geht von 15-20s auf unter 1s für Hersteller-Lookup, funktioniert offline. (3) Bandbreiten-Sparklines: Mini-Diagramme in jeder Adapter-Karte zeigen den Bandbreitenverlauf der letzten 5 Minuten (Chart.js, Empfangen grün, Gesendet blau). (4) UDP-Verbindungen: Neben TCP werden jetzt auch UDP-Endpunkte angezeigt — eigene Metrik-Karte und Protokoll-Badges (TCP/UDP) an jeder Verbindung. (5) WiFi-Details: WLAN-Signalstärke, SSID, Kanal, Frequenzband, Authentifizierung und Verschlüsselung in der Bandbreiten-Ansicht. Signalbalken mit Farbverlauf (rot/gelb/grün). (6) DNS-Cache-Viewer: Aufklappbare Sektion zeigt alle kürzlich aufgelösten Domains mit IP, TTL und Typ. Button zum Leeren des DNS-Caches. (7) Bandbreiten-Daten in Snapshots: Historische Snapshots enthalten jetzt auch die Bandbreitenraten pro Adapter. CSV-Export um Bandbreite und UDP erweitert. (8) Drei-Stufen-UI: Umschalter Basis/Erweitert/Experte im Header — Basis zeigt nur Metrikkarten und Adapter, Erweitert zeigt Sparklines, WiFi, Tracker-Badges und IP-Tabellen, Experte zeigt zusätzlich UDP, DNS-Cache, Aufzeichnungs-Controls und Firewall-Buttons. Einstellung wird in Preferences gespeichert. (9) Npcap-Code entfernt: Ungenutzter npcap-Code aus Backend, IPC und Preload entfernt (~105 Zeilen). Zusätzlich: isPrivateIP-Logik zwischen Frontend und Backend synchronisiert (127.*-Range statt nur 127.0.0.1). |
| 69 | 2026-02-15 | v7.2.1 | improve | **Netzwerk-Monitor: npcap-Leiste entfernt, Tabellen-Hover, WCAG-Fix** - Fünf Verbesserungen: (1) Npcap-Info-Leiste im Live-Feed komplett entfernt — zeigte eine Installations-Aufforderung für ein Feature das noch nicht existiert (Paketerfassung). Backend-Funktionen bleiben für spätere Integration erhalten. (2) Tabellen-Hover-Effekt: Beim Überfahren einer Zeile mit der Maus wird diese dezent hervorgehoben — gilt für Verbindungen-Tab und Live-Feed-Tabelle. (3) WCAG-Fix: Firmennamen in der Verbindungsliste waren in Lila (accent-text) dargestellt und auf dem dunklen Hintergrund schwer lesbar — jetzt in Hellgrau (text-secondary) für besseren Kontrast. Firmen-Spalte von 200px auf 300px verbreitert, ISP-Spalte von 150px auf 200px. (4) Suchfeld-Debouncing: Eingabe wird 250ms verzögert verarbeitet — verhindert Lag bei vielen Verbindungen. (5) Keyboard-Accessibility: Metrikkarten sind jetzt per Tab-Taste erreichbar und per Enter/Leertaste aktivierbar (tabindex + role="button" + Focus-Outline). |
| 68 | 2026-02-15 | v7.2.1 | fix | **Live-Feed: Loopback-Filter, Initial-Dump-Fix, Tabelle volle Breite** - Drei Anzeigeprobleme behoben: (1) Loopback/lokale Verbindungen (127.0.0.1, 0.0.0.0) und "Idle"-Prozesse werden jetzt automatisch herausgefiltert. (2) Beim ersten Öffnen wurden alle bestehenden Verbindungen als "NEU" angezeigt — jetzt wird erst eine Basislinie erstellt, danach werden nur echte Änderungen gemeldet. (3) Die Tabelle füllte nicht die volle Breite aus (leerer blauer Raum rechts), weil alle Spalten auf maximal 200px begrenzt waren — jetzt nutzt die Tabelle die gesamte Breite mit intelligenter Spaltenverteilung (Firma-Spalte am breitesten). Lokale IP-Adressen zeigen "Lokal" in der Firma-Spalte statt leerem Feld. |
| 67 | 2026-02-15 | v7.2.1 | improve | **Netzwerk-Monitor UX-Upgrade** - Einheiten vereinheitlicht: Adapter-Geschwindigkeit immer als Mbit/s oder Gbit/s, Durchsatz als B/s, KB/s oder MB/s. Metrikkarten (Verbindungen, Aktiv, Lauschend, Remote-IPs, Firmen, Tracker, Hochrisiko) sind jetzt klickbar und filtern die Prozessliste direkt. Filter-Indikator zeigt den aktiven Filter mit Zurücksetzen-Button. Npcap: Website-Link durch "Npcap jetzt installieren" Button ersetzt — lädt den Installer automatisch herunter und startet die Installation (UAC-Bestätigung nötig). Farbige State-Pills: Established=grün, Listen=lila, TimeWait/CloseWait=gedämpft. Port-Tooltips für bekannte Protokolle (HTTP, HTTPS, DNS, SSH, RDP etc.). Firmen-Tooltip zeigt alle Firmen bei Hover statt nur die ersten 3. Gesamt-Bytes als separate Zeile unter der Live-Geschwindigkeit. |
| 66 | 2026-02-15 | v7.2.1 | feature | **npcap-Erkennung** - Der Live-Feed Tab zeigt jetzt eine Info-Leiste die den npcap-Status anzeigt: (1) Kein npcap installiert: Lila Hinweis mit Link zu npcap.com/download für erweiterte Paketanalyse (DNS-Abfragen, HTTP-Requests, Protokolle). (2) npcap installiert, kein Admin: Gelber Hinweis mit "Als Administrator starten" Button für Admin-Elevation. (3) npcap + Admin: Grüner Hinweis dass die Paketerfassung verfügbar ist. Die Erkennung prüft ob C:\Windows\System32\Npcap\wpcap.dll existiert. Per Puppeteer-Screenshot verifiziert: Install-Hinweis korrekt sichtbar mit klickbarem Link. |
| 65 | 2026-02-15 | v7.2.1 | feature | **Netzwerk-Aufzeichnung** - Neues Aufzeichnungs-Feature im Live-Feed Tab: "Aufzeichnung starten" Button (rot) startet eine Aufnahme, die alle Verbindungsänderungen (NEU/GESCHLOSSEN/GEÄNDERT) als JSONL-Datei im Verzeichnis %APPDATA%/speicher-analyse/netzwerk-aufzeichnungen/ speichert. Während der Aufnahme zeigt ein pulsierender roter Indikator die Dauer und Anzahl der Events an. "Aufzeichnung stoppen" beendet die Aufnahme und speichert eine Footer-Zeile mit Zusammenfassung. Unterhalb des Live-Feeds erscheint eine Tabelle mit allen gespeicherten Aufzeichnungen (Datum, Dauer, Ereignisse, Grösse) inkl. Löschen-Button und "Ordner öffnen" Link. Neues Backend-Modul main/network-recording.js mit 7 Funktionen und 7 IPC-Handlern. Per Puppeteer-Screenshot verifiziert: Start-Button sichtbar, Rec-Indikator mit Timer "00:08 (19 Events)", gespeicherte Aufzeichnung "4.4 KB" in der Liste. |
| 64 | 2026-02-15 | v7.2.1 | feature | **Live-Feed Tab (Wireshark-light)** - Neuer "Live-Feed" Tab im Netzwerk-Monitor zeigt Verbindungsänderungen in Echtzeit als scrollbaren Event-Stream an. Backend-Connection-Diff vergleicht alle 3 Sekunden den aktuellen Verbindungssnapshot mit dem vorherigen und erkennt drei Event-Typen: NEU (grün, neue Verbindung aufgebaut), GESCHLOSSEN (rot, Verbindung beendet) und GEÄNDERT (gelb, Status-Wechsel). Jeder Event zeigt Zeitstempel, Prozessname, Remote-IP, Port mit Protokoll-Label (HTTP, HTTPS, SSH, DNS etc.), Firma und Land. Pause-Button stoppt die automatische Aktualisierung, Leeren-Button löscht den Feed. Rolling-Buffer speichert maximal 500 Events. Statistik-Leiste zeigt Gesamt-Events, neue und geschlossene Verbindungen. Per Puppeteer-Screenshot verifiziert: 15 Events (6 neue, 9 geschlossene) mit farbcodierten Badges, Prozessnamen und IP-Adressen sichtbar. |
| 63 | 2026-02-15 | v7.2.1 | feature | **Netzwerk-Tabs konsolidiert** - 4 Tabs auf 3 reduziert: "Übersicht" und "Verbindungen" zu einem Tab "Verbindungen" zusammengeführt (Metrikkarten + Bandbreite + Prozessgruppen in einer Ansicht). "Sicherheitsübersicht" entfernt (redundant zum Sidebar-Eintrag "Sicherheits-Check"). "Verlauf" entfernt (wird durch Aufzeichnungsfunktion im Live-Feed ersetzt). Per Puppeteer-Screenshot verifiziert: 5 Karten, 5 Adapter, 22 Prozessgruppen in einer Ansicht. |
| 62 | 2026-02-15 | v7.2.1 | feature | **Auto-Live Netzwerk-Monitor** - Bandbreite aktualisiert sich jetzt automatisch wenn der Netzwerk-Tab sichtbar ist und stoppt beim Verlassen. Echtzeit-Toggle komplett entfernt — kein manuelles Aktivieren mehr nötig. Live-Indikator erscheint automatisch. Tab-Lifecycle über activate()/deactivate() gesteuert, wird von switchToTab() in app.js aufgerufen. Per Puppeteer-Screenshot verifiziert: Ethernet zeigt 2.2 KB/s, Live-Indikator pulsiert, kein Toggle sichtbar. |
| 61 | 2026-02-15 | v7.2.1 | fix | **Echtzeit-Funktion repariert** - Die Echtzeit-Bandbreitenanzeige zeigte dauerhaft "0 KB/s" und reagierte nicht. Drei Ursachen behoben: (1) Beim Aktivieren des Echtzeit-Toggles wurde kein sofortiger Datenabruf gestartet — der erste Wert kam erst nach 15+ Sekunden (5s Intervall + 10s PowerShell). Jetzt wird sofort ein leichtgewichtiger Bandwidth-Abruf gestartet (~2-3s). (2) Das Echtzeit-Polling nutzte den schweren kombinierten getPollingData()-Aufruf (Verbindungen + Zusammenfassung + Bandbreite in einem PowerShell-Aufruf, 10+ Sekunden). Ersetzt durch reines getBandwidth()-Polling, das nur Adapter-Statistiken abfragt (~2-3s). (3) Der Live-Indikator erscheint sofort beim Aktivieren, nicht erst nach dem ersten Datenabruf. Per Puppeteer-Screenshot verifiziert: Ethernet zeigt "75.6 KB/s" empfangen und "4.9 KB/s" gesendet (grün), Werte aktualisieren sich alle 5 Sekunden, Live-Indikator pulsiert. |
| 60 | 2026-02-15 | v7.2.1 | improve | **Netzwerk-Übersicht: Echtzeit-Bandbreite + Sicherheitsübersicht** - Drei Verbesserungen am Netzwerk-Monitor: (1) Netzwerkadapter zeigen jetzt die aktuelle Geschwindigkeit (KB/s, MB/s) statt kumulative Gesamt-Bytes seit dem PC-Start — Delta-Berechnung im Backend speichert den letzten Wert und berechnet die Differenz pro Sekunde. Aktive Geschwindigkeit wird grün hervorgehoben, kumulative Gesamtdaten als Tooltip verfügbar. (2) "Top-Prozesse" in der Übersicht durch eine Sicherheitsübersicht ersetzt — zeigt Hochrisiko-Verbindungen (Länder: RU, CN, KP, IR), Tracker-Verbindungen (Werbenetzwerke) und nicht zugeordnete Verbindungen auf einen Blick. Die alten Top-Prozesse waren redundant zum Verbindungen-Tab. (3) Echtzeit-Button überarbeitet: Polling-Intervall von 10 auf 5 Sekunden reduziert für sichtbarere Bandbreiten-Updates, pulsierender grüner "Live"-Indikator statt rotem "Aufnahme"-Text. Per Puppeteer-Screenshot verifiziert: Ethernet zeigt "69.5 KB/s" empfangen, Sicherheitsübersicht zeigt "Keine Tracker erkannt", Live-Indikator pulsiert im Echtzeit-Modus. |
| 59 | 2026-02-14 | v7.2.1 | improve | **Netzwerk-Scan Performance: 84% schneller** - Scan-Zeit von 150 Sekunden auf 24 Sekunden reduziert durch systematische Parallelisierung aller sequenziellen Engpässe: (1) DNS-Hostnamen-Auflösung im Ping Sweep von sequenziell (GetHostEntry pro Gerät, je ~5s) auf parallel (GetHostEntryAsync + WaitAll mit 10s Limit) umgestellt — spart ~40s. (2) Port-Scan von sequenziellem BeginConnect+WaitOne(500ms) pro IP×Port auf paralleles ConnectAsync + Task.WaitAll(3s) umgestellt — bei 11 Geräten × 18 Ports von ~100s auf ~3s. (3) SMB-Freigaben von sequenziellem "net view" pro IP auf parallele Ausführung via PowerShell RunspacePool (max 5 gleichzeitig) umgestellt. (4) UPnP/SSDP, mDNS/Bonjour und WSD-Discovery von sequenziell (je ~8s, total ~20s) auf parallel via Promise.all umgestellt — nutzen verschiedene UDP-Ports (1900, 5353, 3702). (5) SNMP-Abfragen, Hersteller-Lookup (IEEE) und Gerätemodell-Erkennung von sequenziell auf parallel via Promise.all — sind unabhängige Datenquellen (brauchen nur IP, MAC bzw. Ports). Alle Optimierungen netzwerk- und geräteunabhängig, keine statischen Listen oder Annahmen über die Umgebung. Per Puppeteer-Screenshot verifiziert: alle 11 Geräte korrekt klassifiziert, keine Regression. |
| 58 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Klassifizierung: 3 Schwachstellen für Fremdnetzwerke behoben** - (1) Port 445 (SMB) wird nicht mehr allein als Windows-Signal gewertet — NAS-Geräte (Buffalo, WD, Samba-Server) haben auch SMB offen und wurden fälschlich als "Windows PC" klassifiziert. Jetzt nur noch als Windows wenn zusätzlich Port 135 (RPC) oder 3389 (RDP) offen ist, die wirklich Windows-exklusiv sind. (2) Hostname-Erkennung für "nas" und "brn" (Brother-Drucker) von Substring-Suche auf Wortgrenzen umgestellt — "gymnasium", "nasty-pc" oder "auburn-server" werden nicht mehr fälschlich als NAS bzw. Drucker erkannt. (3) Port 515 (LPD) wird jetzt nur als Drucker gewertet wenn zusätzlich ein reiner Drucker-Hersteller erkannt wurde (HP, Brother, Kyocera, Lexmark, Konica Minolta, Ricoh, Xerox) — Industriegeräte oder IoT-Geräte mit Port 515 werden nicht mehr fälschlich als Drucker angezeigt. Alle Fixes per Puppeteer-Screenshot verifiziert: 11 Geräte korrekt klassifiziert, keine Regression. |
| 57 | 2026-02-14 | v7.2.1 | improve | **Netzwerk-Klassifizierung: Multi-Produkt-Hersteller aus Erkennung entfernt** - 18 Hersteller die verschiedene Gerätetypen produzieren (Canon, Samsung, Apple, Sony, Amazon, Google, LG, Huawei, Xiaomi, Cisco, TP-Link, D-Link, Netgear, Edimax, Ubiquiti, Western Digital, Seagate, Buffalo) wurden aus der automatischen Typ-Zuordnung entfernt. Bisher wurde z.B. jedes Samsung-Gerät als "Mobilgerät" eingestuft, obwohl Samsung auch TVs und Haushaltsgeräte baut. Jetzt werden nur noch Hersteller zugeordnet die wirklich nur einen Gerätetyp im Netzwerk haben (z.B. Synology = NAS, Sonos = Lautsprecher, Hikvision = Kamera). Geräte von Multi-Produkt-Herstellern ohne eindeutige Erkennung (Identity, Ports, Hostname) werden ehrlich als "Unbekanntes Gerät" angezeigt — der Herstellername bleibt sichtbar, bestimmt aber nicht mehr den Typ. Gleiches Prinzip auch bei der NAS-Vendor-Bestätigung (nur noch Synology + QNAP) und beim Apple-Sonderfall im OS-Fallback (entfernt, da Apple iPhones, MacBooks, Apple TV und HomePod baut). Per Puppeteer-Screenshot verifiziert: Visionscape-Gerät jetzt korrekt als "Unbekanntes Gerät" statt "Drucker". |
| 56 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Klassifizierung: 7 Fehlregeln im Tiefenaudit korrigiert** - Systematische Prüfung aller Klassifizierungsregeln auf Fehlpotenzial in fremden Netzwerken. (1) Port 515 (LPD) nicht mehr drucker-exklusiv — ein Visionscape-Industriegerät wurde fälschlich als Drucker angezeigt obwohl nur ein HP-Drucker existiert. (2) Port 554 (RTSP) nicht mehr kamera-exklusiv — Smart TVs und Media Streamer nutzen RTSP ebenfalls; nur noch mit bestätigtem Kamera-Hersteller. (3) Port 631 (IPP) nur noch als Drucker wenn keine Server-Ports (SSH, HTTP+SMB) gleichzeitig offen — Linux-Server mit CUPS nicht mehr als Drucker. (4) Hostname-Regel 'cam' von Substring auf Wortgrenze geändert — "cambridge-pc" wurde fälschlich als Kamera erkannt. (5) mDNS-Regel '_smb._tcp' aus NAS-Zuordnung entfernt — jeder Windows-PC mit Dateifreigabe wurde als NAS klassifiziert. (6) mDNS-Regeln '_rdp/_vnc' von ungültigem Typ 'computer' auf gültiges 'pc' korrigiert. (7) Linux/macOS-Fallback: Geräte mit TTL 64 ohne SSH werden jetzt als "Unbekanntes Gerät" angezeigt statt "Linux/macOS Gerät" — viele IoT-Geräte haben Linux-Firmware und wurden falsch eingestuft. Alle Fixes per Puppeteer-Screenshot visuell verifiziert: 11 Geräte, jedes korrekt klassifiziert, nur noch ein Drucker (HP). |
| 55 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Geräte-Erkennung: 3 Fehlklassifizierungen behoben** - (1) Port 515 (LPD) wird jetzt als drucker-exklusives Protokoll behandelt — ein Gerät mit Port 515 wird immer als Drucker erkannt, nicht mehr als "Linux/macOS Gerät". (2) Geräte mit lokal-administrierter MAC-Adresse (Bit 1 gesetzt, typisch für Smartphones mit MAC-Randomisierung) und ohne Vendor, Ports oder Hostname werden jetzt als "Unbekanntes Gerät" klassifiziert statt fälschlich als "Linux/macOS Gerät". (3) HTTP-Banner-Parsing filtert jetzt extrahierte Modellnamen nochmals gegen generische Begriffe ("Welcome", "Configurator", "Login" etc.) — dadurch erscheint beim Zyxel-Router nicht mehr "Welcome to the Web-Based" als Modellname. Alle 3 Fixes per Puppeteer-Screenshot visuell verifiziert. |
| 54 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Geräte-Erkennung: 40 Wurzelursachen in 8 Phasen behoben** - Komplette Überarbeitung der Geräte-Erkennung in 4 Schichten (Discovery, Identifizierung, Klassifizierung, Darstellung). Phase 1: Synthetische Modellnamen entfernt — Geräte zeigen jetzt "—" statt erfundener Namen wie "NAS synth" oder "Netzwerkdrucker synth". Neues isConfirmed-Feld unterscheidet bestätigte von unbestätigten Geräten, identifiedBy nur noch als Tooltip-Icon. Phase 2: Port-basierte Klassifizierung repariert — Port 515 allein macht kein Gerät mehr zum Drucker (nur mit Drucker-Vendor oder Port 631), Port 5000 allein macht kein Gerät mehr zum NAS (nur mit NAS-Vendor oder beide 5000+5001), Port 9100+80 wird jetzt korrekt als Drucker erkannt. 3 neue Scan-Ports (5900/VNC, 8554/RTSP, 37777/Dahua). Phase 3: "Eigener PC" heisst jetzt "PC / Laptop" und wird korrekt gruppiert, MAC-Adresse des eigenen PCs via WMI, IP-Sortierung numerisch statt lexikographisch, Badge-Klick scrollt korrekt, leere Ports zeigen "—", kein Double-Render beim Filtern. Phase 4: Smartphones und IoT-Geräte die nicht auf Ping antworten werden jetzt über die ARP-Tabelle gefunden. Phase 5: HTTP-Banner-Parsing erkennt jetzt auch "ZyXEL VMG3625 Login" (ohne Trennzeichen), deutsche Router-UIs ("Anmeldung", "Konfiguration"), und Meta-Tags in beiden Attribut-Reihenfolgen. Phase 6: Samsung, Apple, Huawei, Amazon, Google, Ring als Vendor-Patterns ergänzt, Sony Interactive vor Sony (PlayStation nicht mehr als TV), "switch" im Hostname matched nur noch Nintendo Switch. Phase 7: mDNS/WSD-Daten bleiben erhalten wenn HTTP ein Ergebnis liefert, Port 9100 nicht mehr als IPP-Target. Phase 8: Toter Code entfernt (PORT_TYPE_HINTS, ungenutzter Event-Handler), HP SNMP OID nicht mehr pauschal als Drucker. Multicast/Link-Local-Filterung verbessert. |
| 53 | 2026-02-14 | v7.2.1 | feature | **Vollständige Geräte-Erkennung + Gruppierung** - Alle Geräte im Netzwerk zeigen jetzt einen Modellnamen: (1) Eigener PC wird per WMI erkannt (echte Hardware-Daten: Hersteller + Modell). (2) Router-Login-Seiten liefern jetzt den Modellnamen, auch wenn der Titel "Login" oder "Configurator" enthält — der Modellname wird VOR dem generischen Wort extrahiert. Zusätzlich werden h1-Überschriften und Meta-Tags als Fallback geprüft. (3) Geräte die sich per DNS/mDNS selbst benennen (z.B. "XBOX.local") werden automatisch erkannt. (4) Für alle verbleibenden Geräte wird eine Beschreibung aus Hersteller, offenen Ports und Betriebssystem zusammengebaut (z.B. "Visionscape Netzwerkdrucker"). Neue Gruppierung: Geräte werden nach Typ gruppiert (Medien-Geräte, Drucker, etc.) mit ein-/ausklappbaren Gruppen-Headern. Toggle-Button wechselt zwischen gruppierter und flacher Ansicht. Klick auf die Typ-Badges oben scrollt direkt zur jeweiligen Gruppe. |
| 52 | 2026-02-14 | v7.2.1 | feature | **WSD-Scanner, mDNS ohne Firewall-Eingriffe, Layout-Fix** - Drei Verbesserungen für den Netzwerk-Scanner: (1) Neuer WSD-Scanner (Web Services Discovery) erkennt Windows-PCs, Drucker und Scanner ohne Firewall-Änderungen — nutzt Multicast-Probe mit Unicast-Antwort, die von jeder Stateful Firewall automatisch durchgelassen wird. (2) mDNS/Bonjour arbeitet jetzt als stiller Best-Effort — kein Versuch mehr, Windows-Firewall-Regeln zu erstellen. Funktioniert wenn Bonjour installiert ist, sonst 0 Ergebnisse ohne Fehlermeldung. (3) HTTP-Probing um 12 Router/NAS-Hersteller erweitert (Zyxel, TP-Link, Netgear, ASUS, Synology, QNAP, MikroTik, Ubiquiti u.a.). Zusätzlich: Sidebar-Layout-Bug behoben — eine fehlerhafte CSS-Regel machte die Sidebar 240px breit bei Fenstern unter 900px, obwohl nur 56px Icons angezeigt wurden. Dadurch ging fast ein Drittel der Fensterbreite verloren. |
| 51 | 2026-02-14 | v7.2.1 | feature | **Erweiterte Geräte-Erkennung im Netzwerk-Scanner** - Drei neue Erkennungsmethoden: (1) SNMP v2c fragt Router, Switches und Drucker nach Modellname, Firmware-Version, Seriennummer und Standort. (2) SSH Banner Grabbing erkennt das Betriebssystem von Linux-Servern und NAS-Geräten über die SSH-Versionsantwort. (3) mDNS/Bonjour entdeckt alle Netzwerk-Services dynamisch per DNS-SD Meta-Query — das Netzwerk meldet selbst welche Dienste verfügbar sind, keine vordefinierte Liste. Neue Badges in der Geräte-Tabelle zeigen Firmware (FW), Seriennummer (S/N), SSH-Version, mDNS-Services und SNMP-Gerätename. CSV-Export um alle neuen Felder erweitert. Klassifizierung nutzt die erkannten Service-Typen zur besseren Gerätetyp-Zuordnung (z.B. Google Cast = Smart TV, nicht mehr Drucker). |
| 50 | 2026-02-14 | v7.2.1 | fix | **Netzwerk-Monitor: Geräte-Klassifizierung komplett überarbeitet** - Geräte wurden anhand des Hersteller-Namens einem Typ zugeordnet (z.B. Canon = Drucker), obwohl Canon auch Kameras herstellt. Dadurch wurde z.B. der Router als Drucker angezeigt. Jetzt werden Geräte anhand ihres tatsächlichen Verhaltens erkannt: UPnP-Beschreibung (das Gerät sagt was es ist), IPP-Antwort (nur echte Drucker antworten) und Modellname-Erkennung (z.B. "FritzBox" = Router). Die alte Hersteller-Zuordnung dient nur noch als letzter Fallback. Zusätzlich: Anti-Pattern-Regel in CLAUDE.md ergänzt um solche statischen Zuordnungen künftig zu verhindern. |
| 49 | 2026-02-13 | v7.2.1 | fix | **WCAG-Kontrast: Strukturelle Lösung — Farbsystem an der Wurzel gefixt** - Statt einzelne Stellen zu reparieren, wurden die Grundfarben (--text-muted, --text-secondary) selbst verstärkt. Alle 66 Stellen die diese Farben verwenden, sind jetzt automatisch WCAG-konform. Zusätzlich: Weisse Schrift auf farbigen Badges (Risiko, Schweregrad, Status) durch schwarze Schrift ersetzt. Screenshot-Funktion für automatische Tests eingebaut (Electron-native statt Puppeteer). Neues WCAG-Gate-Script prüft automatisch alle 14 Views (1495 Elemente) auf Kontrastverletzungen mit korrektem Alpha-Blending. Ergebnis: 0 Verletzungen. |
| 48 | 2026-02-13 | v7.2.1 | fix | **WCAG-Kontrast: 11 Verletzungen in Optimizer und Netzwerk-Monitor behoben** - Graue Texte auf dunklem Hintergrund (Kategoriezähler, manuelle Pfade, Port-Labels, Tabellen-Überschriften, IP-Adressen) waren zu schwach — von --text-muted auf --text-secondary angehoben. Weisse Schrift auf roten/blauen Badges (Hoch/Niedrig) unlesbar — auf schwarze Schrift gewechselt. Lila Schrift auf halbtransparenten Netzwerk-Badges (Tab-Zähler, Seriennummern, Lokal-Badge) schlecht lesbar — auf --text-primary gewechselt. Erstmals mit echtem Browser-Test verifiziert (Puppeteer + getComputedStyle auf gerenderten Elementen), nicht nur mathematisch mit CSS-Variablen. Neue Skills /visual-verify und /test-issue erstellt, CLAUDE.md Skill-First-Direktive verschärft. |
| 47 | 2026-02-13 | v7.2.1 | fix | **Netzwerk-Monitor: Geräte mit Port 515 (LPD) als Drucker erkannt** - Ein Gerät mit nur Port 515 (LPD = Line Printer Daemon) wurde fälschlich als "Linux/macOS Gerät" angezeigt statt als Drucker. Ursache: Port 515 allein galt als "zu schwaches Signal" für die Drucker-Erkennung. Aber LPD ist ein reines Druckerprotokoll — kein normaler PC hat diesen Port offen. Der Gerätetyp-Erkennungsalgorithmus stuft Port 515 jetzt als eigenständiges Drucker-Signal ein. Per Puppeteer-Screenshot vorher/nachher verifiziert. |
| 46 | 2026-02-13 | v7.2.1 | fix | **Netzwerk-Monitor: 7 UI/UX-Verbesserungen** - (1) Top-Prozesse zeigten PIDs statt Namen — Ursache: PowerShell-Variable `$pid` ist reserviert und kann nicht überschrieben werden, umbenannt zu `$procId`. (2) Suchfeld nur noch im Verbindungen-Tab sichtbar. (3) Besserer Leerzustand für "Lokale Geräte" mit Erklärungstext. (4) Besserer Leerzustand für "Verlauf" mit Erklärung was Snapshots sind. (5) Idle/TimeWait-Verbindungen werden nach unten sortiert. (6) Inaktive Netzwerk-Adapter kompakt einzeilig dargestellt (z.B. "WLAN — Offline"). (7) Snapshot-Button umbenannt zu "Aktualisieren". |

---

## Lessons Learned

Siehe auch: [`archiv/aenderungsprotokoll_v7.0-v7.2.md`](archiv/aenderungsprotokoll_v7.0-v7.2.md) (3 Lessons)
Siehe auch: [`archiv/aenderungsprotokoll_v7.3-v7.5.md`](archiv/aenderungsprotokoll_v7.3-v7.5.md)

### #4: node-pty + Electron: Native Module Builds (2026-02-10)

**Problem:** node-pty@1.1.0 brauchte winpty (GetCommitHash.bat Fehler). node-pty@1.2.0-beta.11 (ConPTY-only) scheiterte an Spectre-Mitigation.

**Lösung:** `scripts/rebuild-pty.js` patcht binding.gyp automatisch vor electron-rebuild. In package.json als postinstall registriert.

**Lehre:** Native Electron-Module können plattformspezifische Build-Probleme haben. Automatische Patches als postinstall-Scripts sind robuster als manuelle Fixes.

---

### #5: Session-Save im before-quit muss synchron sein (2026-02-10)

**Problem:** Electrons `before-quit` Event wartet NICHT auf async Operationen. `await session.saveSession()` wird nie fertig.

**Lösung:** Synchrone Variante: `zlib.gzipSync()` + `fs.writeFileSync()` direkt im before-quit Handler. Die async Variante wird nur für after-scan und manuelles Speichern verwendet.

**Lehre:** Electron Lifecycle-Events (before-quit, will-quit) sind synchron. Für Cleanup-Code immer synchrone APIs verwenden.

---

### #6: Chromium file:// blockiert Module Workers (2026-02-10)

**Problem:** pdf.js Worker-Datei ist `.mjs` → pdf.js erstellt `new Worker(url, { type: 'module' })`. Chromium blockiert Module Workers von `file://` URLs (null origin, CORS-Check fehlschlägt).

**Lösung:** Worker-Script per `fetch()` laden, `export{}` Statement entfernen (ungültig in Classic Worker), als `Blob` + `URL.createObjectURL()` laden. CSP erlaubt `worker-src blob:`.

**Lehre:** In Electron (file:// Protokoll) niemals Module Workers (.mjs) verwenden. Immer Classic Workers via Blob-URL oder .js-Dateien nutzen.

---

### #7: Node.js Buffer.buffer enthält Pool-Daten (2026-02-10)

**Problem:** `fs.readFile()` gibt Buffer zurück. `buffer.buffer` ist der unterliegende ArrayBuffer, der bei kleinen Dateien den GESAMTEN Pool enthält (8KB+). `new Uint8Array(buffer.buffer)` enthält dann Müll-Daten.

**Lösung:** `buffer.buffer.slice(buffer.byteOffset, buffer.byteOffset + buffer.byteLength)` für sauberen ArrayBuffer.

**Lehre:** NIEMALS `buffer.buffer` direkt über IPC senden. Immer `.slice()` für einen sauberen ArrayBuffer verwenden.

---

### #8: Electron Admin-Elevation: Single-Instance Lock Race Condition (2026-02-11)

**Problem:** `Start-Process -Verb RunAs` startet den neuen Prozess, PowerShell gibt Return, und `app.quit()` wird aufgerufen. Aber `app.quit()` ist ASYNC — bis die alte Instanz den Lock freigibt, hat die neue Instanz bereits `requestSingleInstanceLock()` aufgerufen, `false` bekommen, und sich sofort beendet. Ergebnis: App schließt sich und nichts passiert.

**Lösung:** 4 Fixes zusammen:
1. `app.releaseSingleInstanceLock()` EXPLIZIT VOR dem Spawn der neuen Instanz aufrufen (Electron API seit v15)
2. `app.exit(0)` statt `app.quit()` — sofortiger Exit ohne async Event-Queue
3. `execFileAsync` statt `execAsync` — bypassed cmd.exe komplett (keine Double-Quote-Nesting-Probleme)
4. `app._isElevating` Flag — verhindert dass Window-Close/Tray/window-all-closed während der UAC-Wartezeit `app.quit()` aufrufen

**Lehre:**
- `app.quit()` ist ASYNC und feuert Events (before-quit, will-quit, window-all-closed). Für Elevation immer `app.exit(0)` verwenden.
- `requestSingleInstanceLock()` muss EXPLIZIT mit `releaseSingleInstanceLock()` freigegeben werden bevor die neue Instanz startet. Sich auf `app.quit()` verlassen funktioniert nicht (Race Condition).
- `exec()` geht durch `cmd.exe /c "..."` — fragile Verschachtelung bei PowerShell-Befehlen. `execFile()` spawnt direkt.
- Während Elevation (UAC-Wartezeit bis 120s) muss ALLES was `app.quit()` aufrufen könnte blockiert werden: Window-Close, window-all-closed, Tray-Menü. Sonst wird `before-quit` gefeuert, Cleanup-Code räumt die scans-Map ab, und die Elevation-Daten sind weg.
